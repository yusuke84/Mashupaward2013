/*!
 * NCMB JavaScript SDK
 * Version: 1.0.0
 * Build: 25.9.2013
 * http://www.nifty.com
 *
 * Copyright (c) 2013, NIFTY Corporation. All rights reserved.
 * The NCMB JavaScript SDK is freely distributable under the MIT license.
 *
 * Created based on the following Javascript libraries.
 *
 * Parse JavaScript SDK v1.2.8
 * Copyright 2013 Parse, Inc.
 * The Parse JavaScript SDK is freely distributable under the MIT license.
 *
 * Backbone.js v1.0.0
 * Copyright (c) 2010-2013 Jeremy Ashkenas, DocumentCloud Inc.
 * Backbone may be freely distributed under the MIT license.
 *
 * Includes: Underscore.js v1.4.4
 * Copyright 2009-2012 Jeremy Ashkenas, DocumentCloud Inc.
 * The Underscore is freely distributable under the MIT license.
 *
 * Includes: CryptoJS v3.0.2 v3.1.2
 * Copyright (c) 2009-2013 by Jeff Mott. All rights reserved.
 * code.google.com/p/crypto-js/wiki/License
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
 * IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
 * DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
 * TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH
 * THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */
(function(a){a.NCMB=a.NCMB||{};a.NCMB.VERSION="js.1.0.0"}(this));(function(){var w=this;var k=w._;var D={};var C=Array.prototype,f=Object.prototype,r=Function.prototype;var G=C.push,o=C.slice,y=C.concat,d=f.toString,j=f.hasOwnProperty;var K=C.forEach,q=C.map,E=C.reduce,c=C.reduceRight,b=C.filter,B=C.every,p=C.some,n=C.indexOf,l=C.lastIndexOf,u=Array.isArray,e=Object.keys,F=r.bind;var L=function(M){if(M instanceof L){return M}if(!(this instanceof L)){return new L(M)}this._wrapped=M};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=L}exports._=L}else{w._=L}L.VERSION="1.4.4";var H=L.each=L.forEach=function(R,Q,P){if(R==null){return}if(K&&R.forEach===K){R.forEach(Q,P)}else{if(R.length===+R.length){for(var O=0,M=R.length;O<M;O++){if(Q.call(P,R[O],O,R)===D){return}}}else{for(var N in R){if(L.has(R,N)){if(Q.call(P,R[N],N,R)===D){return}}}}}};L.map=L.collect=function(P,O,N){var M=[];if(P==null){return M}if(q&&P.map===q){return P.map(O,N)}H(P,function(S,Q,R){M[M.length]=O.call(N,S,Q,R)});return M};var g="Reduce of empty array with no initial value";L.reduce=L.foldl=L.inject=function(Q,P,M,O){var N=arguments.length>2;if(Q==null){Q=[]}if(E&&Q.reduce===E){if(O){P=L.bind(P,O)}return N?Q.reduce(P,M):Q.reduce(P)}H(Q,function(T,R,S){if(!N){M=T;N=true}else{M=P.call(O,M,T,R,S)}});if(!N){throw new TypeError(g)}return M};L.reduceRight=L.foldr=function(S,P,M,O){var N=arguments.length>2;if(S==null){S=[]}if(c&&S.reduceRight===c){if(O){P=L.bind(P,O)}return N?S.reduceRight(P,M):S.reduceRight(P)}var R=S.length;if(R!==+R){var Q=L.keys(S);R=Q.length}H(S,function(V,T,U){T=Q?Q[--R]:--R;if(!N){M=S[T];N=true}else{M=P.call(O,M,S[T],T,U)}});if(!N){throw new TypeError(g)}return M};L.find=L.detect=function(P,O,N){var M;A(P,function(S,Q,R){if(O.call(N,S,Q,R)){M=S;return true}});return M};L.filter=L.select=function(P,O,N){var M=[];if(P==null){return M}if(b&&P.filter===b){return P.filter(O,N)}H(P,function(S,Q,R){if(O.call(N,S,Q,R)){M[M.length]=S}});return M};L.reject=function(O,N,M){return L.filter(O,function(R,P,Q){return !N.call(M,R,P,Q)},M)};L.every=L.all=function(P,O,N){O||(O=L.identity);var M=true;if(P==null){return M}if(B&&P.every===B){return P.every(O,N)}H(P,function(S,Q,R){if(!(M=M&&O.call(N,S,Q,R))){return D}});return !!M};var A=L.some=L.any=function(P,O,N){O||(O=L.identity);var M=false;if(P==null){return M}if(p&&P.some===p){return P.some(O,N)}H(P,function(S,Q,R){if(M||(M=O.call(N,S,Q,R))){return D}});return !!M};L.contains=L.include=function(N,M){if(N==null){return false}if(n&&N.indexOf===n){return N.indexOf(M)!=-1}return A(N,function(O){return O===M})};L.invoke=function(O,P){var M=o.call(arguments,2);var N=L.isFunction(P);return L.map(O,function(Q){return(N?P:Q[P]).apply(Q,M)})};L.pluck=function(N,M){return L.map(N,function(O){return O[M]})};L.where=function(N,M,O){if(L.isEmpty(M)){return O?null:[]}return L[O?"find":"filter"](N,function(Q){for(var P in M){if(M[P]!==Q[P]){return false}}return true})};L.findWhere=function(N,M){return L.where(N,M,true)};L.max=function(P,O,N){if(!O&&L.isArray(P)&&P[0]===+P[0]&&P.length<65535){return Math.max.apply(Math,P)}if(!O&&L.isEmpty(P)){return -Infinity}var M={computed:-Infinity,value:-Infinity};H(P,function(T,Q,S){var R=O?O.call(N,T,Q,S):T;R>=M.computed&&(M={value:T,computed:R})});return M.value};L.min=function(P,O,N){if(!O&&L.isArray(P)&&P[0]===+P[0]&&P.length<65535){return Math.min.apply(Math,P)}if(!O&&L.isEmpty(P)){return Infinity}var M={computed:Infinity,value:Infinity};H(P,function(T,Q,S){var R=O?O.call(N,T,Q,S):T;R<M.computed&&(M={value:T,computed:R})});return M.value};L.shuffle=function(P){var O;var N=0;var M=[];H(P,function(Q){O=L.random(N++);M[N-1]=M[O];M[O]=Q});return M};var a=function(M){return L.isFunction(M)?M:function(N){return N[M]}};L.sortBy=function(P,O,M){var N=a(O);return L.pluck(L.map(P,function(S,Q,R){return{value:S,index:Q,criteria:N.call(M,S,Q,R)}}).sort(function(T,S){var R=T.criteria;var Q=S.criteria;if(R!==Q){if(R>Q||R===void 0){return 1}if(R<Q||Q===void 0){return -1}}return T.index<S.index?-1:1}),"value")};var t=function(R,Q,N,P){var M={};var O=a(Q||L.identity);H(R,function(U,S){var T=O.call(N,U,S,R);P(M,T,U)});return M};L.groupBy=function(O,N,M){return t(O,N,M,function(P,Q,R){(L.has(P,Q)?P[Q]:(P[Q]=[])).push(R)})};L.countBy=function(O,N,M){return t(O,N,M,function(P,Q){if(!L.has(P,Q)){P[Q]=0}P[Q]++})};L.sortedIndex=function(T,S,P,O){P=P==null?L.identity:a(P);var R=P.call(O,S);var M=0,Q=T.length;while(M<Q){var N=(M+Q)>>>1;P.call(O,T[N])<R?M=N+1:Q=N}return M};L.toArray=function(M){if(!M){return[]}if(L.isArray(M)){return o.call(M)}if(M.length===+M.length){return L.map(M,L.identity)}return L.values(M)};L.size=function(M){if(M==null){return 0}return(M.length===+M.length)?M.length:L.keys(M).length};L.first=L.head=L.take=function(O,N,M){if(O==null){return void 0}return(N!=null)&&!M?o.call(O,0,N):O[0]};L.initial=function(O,N,M){return o.call(O,0,O.length-((N==null)||M?1:N))};L.last=function(O,N,M){if(O==null){return void 0}if((N!=null)&&!M){return o.call(O,Math.max(O.length-N,0))}else{return O[O.length-1]}};L.rest=L.tail=L.drop=function(O,N,M){return o.call(O,(N==null)||M?1:N)};L.compact=function(M){return L.filter(M,L.identity)};var x=function(N,O,M){H(N,function(P){if(L.isArray(P)){O?G.apply(M,P):x(P,O,M)}else{M.push(P)}});return M};L.flatten=function(N,M){return x(N,M,[])};L.without=function(M){return L.difference(M,o.call(arguments,1))};L.uniq=L.unique=function(S,R,Q,P){if(L.isFunction(R)){P=Q;Q=R;R=false}var N=Q?L.map(S,Q,P):S;var O=[];var M=[];H(N,function(U,T){if(R?(!T||M[M.length-1]!==U):!L.contains(M,U)){M.push(U);O.push(S[T])}});return O};L.union=function(){return L.uniq(y.apply(C,arguments))};L.intersection=function(N){var M=o.call(arguments,1);return L.filter(L.uniq(N),function(O){return L.every(M,function(P){return L.indexOf(P,O)>=0})})};L.difference=function(N){var M=y.apply(C,o.call(arguments,1));return L.filter(N,function(O){return !L.contains(M,O)})};L.zip=function(){var M=o.call(arguments);var P=L.max(L.pluck(M,"length"));var O=new Array(P);for(var N=0;N<P;N++){O[N]=L.pluck(M,""+N)}return O};L.object=function(Q,O){if(Q==null){return{}}var M={};for(var P=0,N=Q.length;P<N;P++){if(O){M[Q[P]]=O[P]}else{M[Q[P][0]]=Q[P][1]}}return M};L.indexOf=function(Q,O,P){if(Q==null){return -1}var N=0,M=Q.length;if(P){if(typeof P=="number"){N=(P<0?Math.max(0,M+P):P)}else{N=L.sortedIndex(Q,O);return Q[N]===O?N:-1}}if(n&&Q.indexOf===n){return Q.indexOf(O,P)}for(;N<M;N++){if(Q[N]===O){return N}}return -1};L.lastIndexOf=function(Q,O,P){if(Q==null){return -1}var M=P!=null;if(l&&Q.lastIndexOf===l){return M?Q.lastIndexOf(O,P):Q.lastIndexOf(O)}var N=(M?P:Q.length);while(N--){if(Q[N]===O){return N}}return -1};L.range=function(R,P,Q){if(arguments.length<=1){P=R||0;R=0}Q=arguments[2]||1;var N=Math.max(Math.ceil((P-R)/Q),0);var M=0;var O=new Array(N);while(M<N){O[M++]=R;R+=Q}return O};L.bind=function(O,N){if(O.bind===F&&F){return F.apply(O,o.call(arguments,1))}var M=o.call(arguments,2);return function(){return O.apply(N,M.concat(o.call(arguments)))}};L.partial=function(N){var M=o.call(arguments,1);return function(){return N.apply(this,M.concat(o.call(arguments)))}};L.bindAll=function(N){var M=o.call(arguments,1);if(M.length===0){M=L.functions(N)}H(M,function(O){N[O]=L.bind(N[O],N)});return N};L.memoize=function(O,N){var M={};N||(N=L.identity);return function(){var P=N.apply(this,arguments);return L.has(M,P)?M[P]:(M[P]=O.apply(this,arguments))}};L.delay=function(N,O){var M=o.call(arguments,2);return setTimeout(function(){return N.apply(null,M)},O)};L.defer=function(M){return L.delay.apply(L,[M,1].concat(o.call(arguments,1)))};L.throttle=function(R,T){var P,O,S,M;var Q=0;var N=function(){Q=new Date;S=null;M=R.apply(P,O)};return function(){var U=new Date;var V=T-(U-Q);P=this;O=arguments;if(V<=0){clearTimeout(S);S=null;Q=U;M=R.apply(P,O)}else{if(!S){S=setTimeout(N,V)}}return M}};L.debounce=function(O,Q,N){var P,M;return function(){var U=this,T=arguments;var S=function(){P=null;if(!N){M=O.apply(U,T)}};var R=N&&!P;clearTimeout(P);P=setTimeout(S,Q);if(R){M=O.apply(U,T)}return M}};L.once=function(O){var M=false,N;return function(){if(M){return N}M=true;N=O.apply(this,arguments);O=null;return N}};L.wrap=function(M,N){return function(){var O=[M];G.apply(O,arguments);return N.apply(this,O)}};L.compose=function(){var M=arguments;return function(){var N=arguments;for(var O=M.length-1;O>=0;O--){N=[M[O].apply(this,N)]}return N[0]}};L.after=function(N,M){if(N<=0){return M()}return function(){if(--N<1){return M.apply(this,arguments)}}};L.keys=e||function(O){if(O!==Object(O)){throw new TypeError("Invalid object")}var N=[];for(var M in O){if(L.has(O,M)){N[N.length]=M}}return N};L.values=function(O){var M=[];for(var N in O){if(L.has(O,N)){M.push(O[N])}}return M};L.pairs=function(O){var N=[];for(var M in O){if(L.has(O,M)){N.push([M,O[M]])}}return N};L.invert=function(O){var M={};for(var N in O){if(L.has(O,N)){M[O[N]]=N}}return M};L.functions=L.methods=function(O){var N=[];for(var M in O){if(L.isFunction(O[M])){N.push(M)}}return N.sort()};L.extend=function(M){H(o.call(arguments,1),function(N){if(N){for(var O in N){M[O]=N[O]}}});return M};L.pick=function(N){var O={};var M=y.apply(C,o.call(arguments,1));H(M,function(P){if(P in N){O[P]=N[P]}});return O};L.omit=function(O){var P={};var N=y.apply(C,o.call(arguments,1));for(var M in O){if(!L.contains(N,M)){P[M]=O[M]}}return P};L.defaults=function(M){H(o.call(arguments,1),function(N){if(N){for(var O in N){if(M[O]==null){M[O]=N[O]}}}});return M};L.clone=function(M){if(!L.isObject(M)){return M}return L.isArray(M)?M.slice():L.extend({},M)};L.tap=function(N,M){M(N);return N};var I=function(T,S,N,O){if(T===S){return T!==0||1/T==1/S}if(T==null||S==null){return T===S}if(T instanceof L){T=T._wrapped}if(S instanceof L){S=S._wrapped}var Q=d.call(T);if(Q!=d.call(S)){return false}switch(Q){case"[object String]":return T==String(S);case"[object Number]":return T!=+T?S!=+S:(T==0?1/T==1/S:T==+S);case"[object Date]":case"[object Boolean]":return +T==+S;case"[object RegExp]":return T.source==S.source&&T.global==S.global&&T.multiline==S.multiline&&T.ignoreCase==S.ignoreCase}if(typeof T!="object"||typeof S!="object"){return false}var M=N.length;while(M--){if(N[M]==T){return O[M]==S}}N.push(T);O.push(S);var V=0,W=true;if(Q=="[object Array]"){V=T.length;W=V==S.length;if(W){while(V--){if(!(W=I(T[V],S[V],N,O))){break}}}}else{var R=T.constructor,P=S.constructor;if(R!==P&&!(L.isFunction(R)&&(R instanceof R)&&L.isFunction(P)&&(P instanceof P))){return false}for(var U in T){if(L.has(T,U)){V++;if(!(W=L.has(S,U)&&I(T[U],S[U],N,O))){break}}}if(W){for(U in S){if(L.has(S,U)&&!(V--)){break}}W=!V}}N.pop();O.pop();return W};L.isEqual=function(N,M){return I(N,M,[],[])};L.isEmpty=function(N){if(N==null){return true}if(L.isArray(N)||L.isString(N)){return N.length===0}for(var M in N){if(L.has(N,M)){return false}}return true};L.isElement=function(M){return !!(M&&M.nodeType===1)};L.isArray=u||function(M){return d.call(M)=="[object Array]"};L.isObject=function(M){return M===Object(M)};H(["Arguments","Function","String","Number","Date","RegExp"],function(M){L["is"+M]=function(N){return d.call(N)=="[object "+M+"]"}});if(!L.isArguments(arguments)){L.isArguments=function(M){return !!(M&&L.has(M,"callee"))}}if(typeof(/./)!=="function"){L.isFunction=function(M){return typeof M==="function"}}L.isFinite=function(M){return isFinite(M)&&!isNaN(NCMBFloat(M))};L.isNaN=function(M){return L.isNumber(M)&&M!=+M};L.isBoolean=function(M){return M===true||M===false||d.call(M)=="[object Boolean]"};L.isNull=function(M){return M===null};L.isUndefined=function(M){return M===void 0};L.has=function(N,M){return j.call(N,M)};L.noConflict=function(){w._=k;return this};L.identity=function(M){return M};L.times=function(Q,P,O){var M=Array(Q);for(var N=0;N<Q;N++){M[N]=P.call(O,N)}return M};L.random=function(N,M){if(M==null){M=N;N=0}return N+Math.floor(Math.random()*(M-N+1))};var m={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};m.unescape=L.invert(m.escape);var J={escape:new RegExp("["+L.keys(m.escape).join("")+"]","g"),unescape:new RegExp("("+L.keys(m.unescape).join("|")+")","g")};L.each(["escape","unescape"],function(M){L[M]=function(N){if(N==null){return""}return(""+N).replace(J[M],function(O){return m[M][O]})}});L.result=function(M,O){if(M==null){return null}var N=M[O];return L.isFunction(N)?N.call(M):N};L.mixin=function(M){H(L.functions(M),function(N){var O=L[N]=M[N];L.prototype[N]=function(){var P=[this._wrapped];G.apply(P,arguments);return s.call(this,O.apply(L,P))}})};var z=0;L.uniqueId=function(M){var N=++z+"";return M?M+N:N};L.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var v=/(.)^/;var h={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"};var i=/\\|'|\r|\n|\t|\u2028|\u2029/g;L.template=function(U,P,O){var N;O=L.defaults({},O,L.templateSettings);var Q=new RegExp([(O.escape||v).source,(O.interpolate||v).source,(O.evaluate||v).source].join("|")+"|$","g");var R=0;var M="__p+='";U.replace(Q,function(W,X,V,Z,Y){M+=U.slice(R,Y).replace(i,function(aa){return"\\"+h[aa]});if(X){M+="'+\n((__t=("+X+"))==null?'':_.escape(__t))+\n'"}if(V){M+="'+\n((__t=("+V+"))==null?'':__t)+\n'"}if(Z){M+="';\n"+Z+"\n__p+='"}R=Y+W.length;return W});M+="';\n";if(!O.variable){M="with(obj||{}){\n"+M+"}\n"}M="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+M+"return __p;\n";try{N=new Function(O.variable||"obj","_",M)}catch(S){S.source=M;throw S}if(P){return N(P,L)}var T=function(V){return N.call(this,V,L)};T.source="function("+(O.variable||"obj")+"){\n"+M+"}";return T};L.chain=function(M){return L(M).chain()};var s=function(M){return this._chain?L(M).chain():M};L.mixin(L);H(["pop","push","reverse","shift","sort","splice","unshift"],function(M){var N=C[M];L.prototype[M]=function(){var O=this._wrapped;N.apply(O,arguments);if((M=="shift"||M=="splice")&&O.length===0){delete O[0]}return s.call(this,O)}});H(["concat","join","slice"],function(M){var N=C[M];L.prototype[M]=function(){return s.call(this,N.apply(this._wrapped,arguments))}});L.extend(L.prototype,{chain:function(){this._chain=true;return this},value:function(){return this._wrapped}})}).call(this);var CryptoJS=CryptoJS||function(t,s){var w={},v=w.lib={},n=v.Base=function(){function b(){}return{extend:function(e){b.prototype=this;var f=new b;e&&f.mixIn(e);f.$super=this;return f},create:function(){var e=this.extend();e.init.apply(e,arguments);return e},init:function(){},mixIn:function(e){for(var f in e){e.hasOwnProperty(f)&&(this[f]=e[f])}e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.$super.extend(this)}}}(),p=v.WordArray=n.extend({init:function(b,e){b=this.words=b||[];this.sigBytes=e!=s?e:4*b.length},toString:function(b){return(b||j).stringify(this)},concat:function(f){var g=this.words,h=f.words,i=this.sigBytes,f=f.sigBytes;this.clamp();if(i%4){for(var e=0;e<f;e++){g[i+e>>>2]|=(h[e>>>2]>>>24-8*(e%4)&255)<<24-8*((i+e)%4)}}else{if(65535<h.length){for(e=0;e<f;e+=4){g[i+e>>>2]=h[e>>>2]}}else{g.push.apply(g,h)}}this.sigBytes+=f;return this},clamp:function(){var f=this.words,e=this.sigBytes;f[e>>>2]&=4294967295<<32-8*(e%4);f.length=t.ceil(e/4)},clone:function(){var b=n.clone.call(this);b.words=this.words.slice(0);return b},random:function(f){for(var e=[],g=0;g<f;g+=4){e.push(4294967296*t.random()|0)}return p.create(e,f)}}),d=w.enc={},j=d.Hex={stringify:function(g){for(var f=g.words,g=g.sigBytes,i=[],k=0;k<g;k++){var h=f[k>>>2]>>>24-8*(k%4)&255;i.push((h>>>4).toString(16));i.push((h&15).toString(16))}return i.join("")},parse:function(f){for(var e=f.length,g=[],h=0;h<e;h+=2){g[h>>>3]|=parseInt(f.substr(h,2),16)<<24-4*(h%8)}return p.create(g,e/2)}},c=d.Latin1={stringify:function(f){for(var e=f.words,f=f.sigBytes,g=[],h=0;h<f;h++){g.push(String.fromCharCode(e[h>>>2]>>>24-8*(h%4)&255))}return g.join("")},parse:function(f){for(var e=f.length,g=[],h=0;h<e;h++){g[h>>>2]|=(f.charCodeAt(h)&255)<<24-8*(h%4)}return p.create(g,e)}},a=d.Utf8={stringify:function(f){try{return decodeURIComponent(escape(c.stringify(f)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(b){return c.parse(unescape(encodeURIComponent(b)))}},x=v.BufferedBlockAlgorithm=n.extend({reset:function(){this._data=p.create();this._nDataBytes=0},_append:function(b){"string"==typeof b&&(b=a.parse(b));this._data.concat(b);this._nDataBytes+=b.sigBytes},_process:function(i){var h=this._data,o=h.words,q=h.sigBytes,m=this.blockSize,k=q/(4*m),k=i?t.ceil(k):t.max((k|0)-this._minBufferSize,0),i=k*m,q=t.min(4*i,q);if(i){for(var l=0;l<i;l+=m){this._doProcessBlock(o,l)}l=o.splice(0,i);h.sigBytes-=q}return p.create(l,q)},clone:function(){var b=n.clone.call(this);b._data=this._data.clone();return b},_minBufferSize:0});v.Hasher=x.extend({init:function(){this.reset()},reset:function(){x.reset.call(this);this._doReset()},update:function(b){this._append(b);this._process();return this},finalize:function(b){b&&this._append(b);this._doFinalize();return this._hash},clone:function(){var b=x.clone.call(this);b._hash=this._hash.clone();return b},blockSize:16,_createHelper:function(b){return function(e,f){return b.create(f).finalize(e)}},_createHmacHelper:function(b){return function(e,f){return u.HMAC.create(b,f).finalize(e)}}});var u=w.algo={};return w}(Math);(function(g){var d=CryptoJS,n=d.lib,j=n.WordArray,n=n.Hasher,b=d.algo,c=[],p=[];(function(){function l(f){for(var e=g.sqrt(f),m=2;m<=e;m++){if(!(f%m)){return !1}}return !0}function k(e){return 4294967296*(e-(e|0))|0}for(var h=2,i=0;64>i;){l(h)&&(8>i&&(c[i]=k(g.pow(h,0.5))),p[i]=k(g.pow(h,1/3)),i++),h++}})();var a=[],b=b.SHA256=n.extend({_doReset:function(){this._hash=j.create(c.slice(0))},_doProcessBlock:function(x,w){for(var A=this._hash.words,v=A[0],B=A[1],s=A[2],y=A[3],z=A[4],u=A[5],q=A[6],r=A[7],o=0;64>o;o++){if(16>o){a[o]=x[w+o]|0}else{var t=a[o-15],m=a[o-2];a[o]=((t<<25|t>>>7)^(t<<14|t>>>18)^t>>>3)+a[o-7]+((m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10)+a[o-16]}t=r+((z<<26|z>>>6)^(z<<21|z>>>11)^(z<<7|z>>>25))+(z&u^~z&q)+p[o]+a[o];m=((v<<30|v>>>2)^(v<<19|v>>>13)^(v<<10|v>>>22))+(v&B^v&s^B&s);r=q;q=u;u=z;z=y+t|0;y=s;s=B;B=v;v=t+m|0}A[0]=A[0]+v|0;A[1]=A[1]+B|0;A[2]=A[2]+s|0;A[3]=A[3]+y|0;A[4]=A[4]+z|0;A[5]=A[5]+u|0;A[6]=A[6]+q|0;A[7]=A[7]+r|0},_doFinalize:function(){var l=this._data,k=l.words,h=8*this._nDataBytes,i=8*l.sigBytes;k[i>>>5]|=128<<24-i%32;k[(i+64>>>9<<4)+15]=h;l.sigBytes=4*k.length;this._process()}});d.SHA256=n._createHelper(b);d.HmacSHA256=n._createHmacHelper(b)})(Math);(function(){var b=CryptoJS,a=b.enc.Utf8;b.algo.HMAC=b.lib.Base.extend({init:function(p,n){p=this._hasher=p.create();"string"==typeof n&&(n=a.parse(n));var l=p.blockSize,j=4*l;n.sigBytes>j&&(n=p.finalize(n));for(var g=this._oKey=n.clone(),i=this._iKey=n.clone(),d=g.words,c=i.words,s=0;s<l;s++){d[s]^=1549556828,c[s]^=909522486}g.sigBytes=i.sigBytes=j;this.reset()},reset:function(){var c=this._hasher;c.reset();c.update(this._iKey)},update:function(c){this._hasher.update(c);return this},finalize:function(d){var c=this._hasher,d=c.finalize(d);c.reset();return c.finalize(this._oKey.clone().concat(d))}})})();(function(){var e=CryptoJS;var a=e.lib;var b=a.WordArray;var d=e.enc;var c=d.Base64={stringify:function(l){var n=l.words;var p=l.sigBytes;var g=this._map;l.clamp();var m=[];for(var k=0;k<p;k+=3){var s=(n[k>>>2]>>>(24-(k%4)*8))&255;var q=(n[(k+1)>>>2]>>>(24-((k+1)%4)*8))&255;var o=(n[(k+2)>>>2]>>>(24-((k+2)%4)*8))&255;var r=(s<<16)|(q<<8)|o;for(var h=0;(h<4)&&(k+h*0.75<p);h++){m.push(g.charAt((r>>>(6*(3-h)))&63))}}var f=g.charAt(64);if(f){while(m.length%4){m.push(f)}}return m.join("")},parse:function(o){var m=o.length;var g=this._map;var f=g.charAt(64);if(f){var p=o.indexOf(f);if(p!=-1){m=p}}var n=[];var l=0;for(var k=0;k<m;k++){if(k%4){var j=g.indexOf(o.charAt(k-1))<<((k%4)*2);var h=g.indexOf(o.charAt(k))>>>(6-(k%4)*2);n[l>>>2]|=(j|h)<<(24-(l%4)*8);l++}}return b.create(n,l)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}());(function(a){a.NCMB=a.NCMB||{};var b=a.NCMB;b._=_.noConflict();if(typeof(localStorage)!=="undefined"){b.localStorage=localStorage}if(typeof(XMLHttpRequest)!=="undefined"){b.XMLHttpRequest=XMLHttpRequest}if(typeof($)!=="undefined"){b.$=$}var c=function(){};var d=function(f,e,g){var h;if(e&&e.hasOwnProperty("constructor")){h=e.constructor}else{h=function(){f.apply(this,arguments)}}b._.extend(h,f);c.prototype=f.prototype;h.prototype=new c();if(e){b._.extend(h.prototype,e)}if(g){b._.extend(h,g)}h.prototype.constructor=h;h.__super__=f.prototype;return h};b.serverURL="https://mb.api.cloud.nifty.com/2013-09-01/";b.initialize=function(e,f){b._initialize(e,f)};b._initialize=function(e,f){b.applicationKey=e;b.clientKey=f};b._getNCMBPath=function(e){if(!b.applicationKey){throw"You need to call NCMB.initialize before using NCMB."}if(!e){e=""}if(!b._.isString(e)){throw"Tried to get a localStorage path that wasn't a String."}if(e[0]==="/"){e=e.substring(1)}return"NCMB/"+b.applicationKey+"/"+e};b._NCMBDate=function(e){var l=new RegExp("^([0-9]{1,4})-([0-9]{1,2})-([0-9]{1,2})T([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2})(.([0-9]+))?Z$");var j=l.exec(e);if(!j){return null}var m=j[1]||0;var k=(j[2]||1)-1;var n=j[3]||0;var h=j[4]||0;var g=j[5]||0;var f=j[6]||0;var i=j[8]||0;return new Date(Date.UTC(m,k,n,h,g,f,i))};b._createSignature=function(F,m,e,s,o,n){var A="";var j=b.applicationKey;var x=n;var w=b.clientKey;var y=o;var v=encodeURI(s);var g=v.substring(v.lastIndexOf("//")+2);var f=g.substring(0,g.indexOf("/"));var p=v.indexOf("?");var r="";var B={};if(p==-1){r=v.substring(v.lastIndexOf(f)+f.length)}else{var l=v.substring(p+1);r=v.substring(v.lastIndexOf(f)+f.length,p);g=l.split("&");for(var D=0;D<g.length;D++){p=g[D].indexOf("=");B[g[D].substring(0,p)]=g[D].substring(p+1)}}B.SignatureMethod="HmacSHA256";B.SignatureVersion="2";B["X-NCMB-Application-Key"]=j;B["X-NCMB-Timestamp"]=x;var u={};var z=[];var C,D,E;for(C in B){if(B.hasOwnProperty(C)){z.push(C)}}z.sort();E=z.length;for(D=0;D<E;D++){C=z[D];u[C]=B[C]}var q="";for(C in u){if(u.hasOwnProperty(C)){if(q!=""){q+="&"}q=q+C+"="+u[C]}}var t=y+"\n"+f+"\n"+r+"\n"+q;var h=CryptoJS.HmacSHA256(t,w);var A=CryptoJS.enc.Base64.stringify(h);return A};b._ajax=function(n,l,e,f,i,g,k,o,m){var r={success:o,error:m};var q=new b.Promise();var j=false;var p=new b.XMLHttpRequest();p.onreadystatechange=function(){if(p.readyState===4){if(j){return}j=true;if(p.status>=200&&p.status<300){var s;try{if(p.responseText){if(n!="files"||e!="GET"||l==null){s=JSON.parse(p.responseText)}else{s=p.responseText}}else{s={}}}catch(t){q.reject(t)}if(s){q.resolve(s,p.status,p)}}else{q.reject(p)}}};p.open(e,f,true);p.setRequestHeader("X-NCMB-Application-Key",b.applicationKey);p.setRequestHeader("X-NCMB-Timestamp",k);p.setRequestHeader("X-NCMB-Signature",g);if(n=="files"&&e=="POST"){var h=new FormData();h.append("file",i.file);h.append("acl",i.acl);p.send(h)}else{i=JSON.stringify(i);p.setRequestHeader("Content-Type","application/json");p.send(i)}return q._thenRunCallbacks(r)};b._extend=function(e,f){var g=d(this,e,f);g.extend=this.extend;return g};b._request=function(n,k,l,e,h){if(!b.applicationKey){throw"You must specify your applicationKey using NCMB.initialize"}if(!b.clientKey){throw"You must specify a key using NCMB.initialize"}if(k=="file"&&n=="classes"){n="files";k=null}if(k=="user"&&n=="classes"){n="users";k=null}if(k=="push"&&n=="classes"){n="push";k=null}if(k=="role"&&n=="classes"){n="roles";k=null}if(n!=="classes"&&n!=="batch"&&n!=="users"&&n!=="files"&&n!=="requestPasswordReset"&&n!=="mailAddressConfirm"&&n!=="login"&&n!=="logout"&&n!=="push"&&n!=="roles"&&n!=="installations"){throw"Bad route: '"+n+"'."}var f=b.serverURL;if(f.charAt(f.length-1)!=="/"){f+="/"}f+=n;if(k){f+="/"+k}if(l){f+="/"+l}if(h){if(h.where||h.include||h.order||h.skip||h.count||h.limit){f+="?"}if(n=="login"){if(h.userName||h.password){f+="?"}}if(h.where){if(f.charAt(f.length-1)=="?"){f+="where="+JSON.stringify(h.where)}else{f+="&where="+JSON.stringify(h.where)}delete h.where}if(h.include){if(f.charAt(f.length-1)=="?"){f+="include="+h.include}else{f+="&include="+h.include}delete h.include}if(h.order){if(f.charAt(f.length-1)=="?"){f+="order="+h.order}else{f+="&order="+h.order}delete h.order}if(h.skip){if(f.charAt(f.length-1)=="?"){f+="skip="+JSON.stringify(h.skip)}else{f+="&skip="+JSON.stringify(h.skip)}delete h.skip}if(h.count){if(f.charAt(f.length-1)=="?"){f+="count="+JSON.stringify(h.count)}else{f+="&count="+JSON.stringify(h.count)}delete h.count}if(h.limit){if(f.charAt(f.length-1)=="?"){f+="limit="+JSON.stringify(h.limit)}else{f+="&limit="+JSON.stringify(h.limit)}delete h.limit}if(n=="login"){if(h.userName){if(f.charAt(f.length-1)=="?"){f+="userName="+h.userName}else{f+="&userName="+h.userName}delete h.userName}if(h.password){if(f.charAt(f.length-1)=="?"){f+="password="+h.password}else{f+="&password="+h.password}delete h.password}}}var g=new Date();if(!Date.prototype.toISOString){(function(){function o(q){var p=String(q);if(p.length===1){p="0"+p}return p}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+o(this.getUTCMonth()+1)+"-"+o(this.getUTCDate())+"T"+o(this.getUTCHours())+":"+o(this.getUTCMinutes())+":"+o(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1000).toFixed(3)).slice(2,5)+"Z"}}())}var m=g.toISOString();while(m.indexOf(":")>-1){m=m.replace(":","%3A")}var j=m;signature=b._createSignature(n,k,l,f,e,j);var i=h;return b._ajax(n,k,e,f,i,signature,j).then(null,function(o){var q;if(o&&o.responseText){try{var p=JSON.parse(o.responseText);if(p){q=new b.Error(p.code,p.error)}}catch(r){}}q=q||new b.Error(-1,o.responseText);return b.Promise.error(q)})};b._getValue=function(e,f){if(!(e&&e[f])){return null}return b._.isFunction(e[f])?e[f]():e[f]};b._encode=function(i,h,g){var f=b._;if(i instanceof b.Object){if(g){throw"NCMB.Objects not allowed here"}if(!h||f.include(h,i)||!i._hasData){return i._toPointer()}if(!i.dirty()){h=h.concat(i);return b._encode(i._toFullJSON(h),h,g)}throw"Tried to save an object with a pointer to a new, unsaved object."}if(i instanceof b.ACL){return i.toJSON()}if(f.isDate(i)){return{__type:"Date",iso:i.toJSON()}}if(f.isArray(i)){return f.map(i,function(j){return b._encode(j,h,g)})}if(f.isRegExp(i)){return i.source}if(i instanceof b.Relation){return i.toJSON()}if(i instanceof b.Op){return i.toJSON()}if(i instanceof b.File){if(!i.url()){throw"Tried to save an object containing an unsaved file."}return{__type:"File",name:i.name(),url:i.url()}}if(f.isObject(i)){var e={};b._objectEach(i,function(l,j){e[j]=b._encode(l,h,g)});return e}return i};b._decode=function(h,k){var f=b._;if(h=="authData"){return k}if(!f.isObject(k)){return k}if(f.isArray(k)){b._arrayEach(k,function(n,m){k[m]=b._decode(m,n)});return k}if(k instanceof b.Object){return k}if(k instanceof b.File){return k}if(k instanceof b.Op){return k}if(k.__op){return b.Op._decode(k)}if(k.__type==="Pointer"){var l=b.Object._create(k.className);l._finishFetch({objectId:k.objectId},false);return l}if(k.__type==="Object"){var i=k.className;delete k.__type;delete k.className;var e=b.Object._create(i);e._finishFetch(k,true);return e}if(k.__type==="Date"){return b._NCMBDate(k.iso)}if(h==="ACL"){if(k instanceof b.ACL){return k}return new b.ACL(k)}if(k.__type==="Relation"){var j=new b.Relation(null,h);j.targetClassName=k.className;return j}if(k.__type==="File"){var g=new b.File(k.name);g._url=k.url;return g}b._objectEach(k,function(n,m){k[m]=b._decode(m,n)});return k};b._arrayEach=b._.each;b._traverse=function(f,g,e){if(f instanceof b.Object){e=e||[];if(b._.indexOf(e,f)>=0){return}e.push(f);b._traverse(f.attributes,g,e);return g(f)}if(f instanceof b.Relation||f instanceof b.File){return g(f)}if(b._.isArray(f)){b._.each(f,function(j,i){var h=b._traverse(j,g,e);if(h){f[i]=h}});return g(f)}if(b._.isObject(f)){b._each(f,function(j,i){var h=b._traverse(j,g,e);if(h){f[i]=h}});return g(f)}return g(f)};b._objectEach=b._each=function(f,g){var e=b._;if(e.isObject(f)){e.each(e.keys(f),function(h){g(f[h],h)})}else{e.each(f,g)}};b._isNullOrUndefined=function(e){return b._.isNull(e)||b._.isUndefined(e)};b._createUuid=function(){var e=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e())}}(this));(function(a){a.NCMB=a.NCMB||{};var c=a.NCMB;var b=c._;c.Promise=function(){this._resolved=false;this._rejected=false;this._resolvedCallbacks=[];this._rejectedCallbacks=[]};b.extend(c.Promise,{is:function(d){if(d&&d.then&&b.isFunction(d.then)){return d&&d.then&&b.isFunction(d.then)}else{return false}},as:function(){var d=new c.Promise();d.resolve.apply(d,arguments);return d},error:function(){var d=new c.Promise();d.reject.apply(d,arguments);return d},when:function(g){var i;if(g&&c._isNullOrUndefined(g.length)){i=arguments}else{i=g}var h=i.length;var e=false;var f=[];var k=[];f.length=i.length;k.length=i.length;if(h===0){return c.Promise.as.apply(this,f)}var j=new c.Promise();var d=function(){h=h-1;if(h===0){if(e){j.reject(k)}else{j.resolve.apply(j,f)}}};c._arrayEach(i,function(l,m){if(c.Promise.is(l)){l.then(function(n){f[m]=n;d()},function(n){k[m]=n;e=true;d()})}else{f[m]=l;d()}});return j},_continueWhile:function(d,e){if(d()){return e().then(function(){return c.Promise._continueWhile(d,e)})}return c.Promise.as()}});b.extend(c.Promise.prototype,{resolve:function(d){if(this._resolved||this._rejected){throw"A promise was resolved even though it had already been "+(this._resolved?"resolved":"rejected")+"."}this._resolved=true;this._result=arguments;var e=arguments;c._arrayEach(this._resolvedCallbacks,function(f){f.apply(this,e)});this._resolvedCallbacks=[];this._rejectedCallbacks=[]},reject:function(d){if(this._resolved||this._rejected){throw"A promise was rejected even though it had already been "+(this._resolved?"resolved":"rejected")+"."}this._rejected=true;this._error=d;c._arrayEach(this._rejectedCallbacks,function(e){e(d)});this._resolvedCallbacks=[];this._rejectedCallbacks=[]},then:function(d,f){var g=new c.Promise();var h=function(){var i=arguments;if(d){i=[d.apply(this,i)]}if(i.length===1&&c.Promise.is(i[0])){i[0].then(function(){g.resolve.apply(g,arguments)},function(j){g.reject(j)})}else{g.resolve.apply(g,i)}};var e=function(j){var i=[];if(f){i=[f(j)];if(i.length===1&&c.Promise.is(i[0])){i[0].then(function(){g.resolve.apply(g,arguments)},function(k){g.reject(k)})}else{g.reject(i[0])}}else{g.reject(j)}};if(this._resolved){h.apply(this,this._result)}else{if(this._rejected){e(this._error)}else{this._resolvedCallbacks.push(h);this._rejectedCallbacks.push(e)}}return g},_thenRunCallbacks:function(f,e){var d;if(b.isFunction(f)){var g=f;d={success:function(h){g(h,null)},error:function(h){g(null,h)}}}else{d=b.clone(f)}d=d||{};return this.then(function(h){if(d.success){d.success.apply(this,arguments)}else{if(e){e.trigger("sync",e,h,d)}}return c.Promise.as.apply(c.Promise,arguments)},function(h){if(d.error){if(!b.isUndefined(e)){d.error(e,h)}else{d.error(h)}}else{if(e){e.trigger("error",e,h,d)}}return c.Promise.error(h)})},_continueWith:function(d){return this.then(function(){return d(arguments,null)},function(e){return d(null,e)})}})}(this));(function(a){a.NCMB=a.NCMB||{};var c=a.NCMB;var b=c._;c.Error=function(e,d){this.code=e;this.message=d};b.extend(c.Error,{OTHER_CAUSE:-1,INTERNAL_SERVER_ERROR:1,CONNECTION_FAILED:100,OBJECT_NOT_FOUND:101,INVALID_QUERY:102,INVALID_CLASS_NAME:103,MISSING_OBJECT_ID:104,INVALID_KEY_NAME:105,INVALID_POINTER:106,INVALID_JSON:107,COMMAND_UNAVAILABLE:108,NOT_INITIALIZED:109,INCORRECT_TYPE:111,INVALID_CHANNEL_NAME:112,PUSH_MISCONFIGURED:115,OBJECT_TOO_LARGE:116,OPERATION_FORBIDDEN:119,CACHE_MISS:120,INVALID_NESTED_KEY:121,INVALID_FILE_NAME:122,INVALID_ACL:123,TIMEOUT:124,INVALID_EMAIL_ADDRESS:125,MISSING_CONTENT_TYPE:126,MISSING_CONTENT_LENGTH:127,INVALID_CONTENT_LENGTH:128,FILE_TOO_LARGE:129,FILE_SAVE_ERROR:130,FILE_DELETE_ERROR:153,DUPLICATE_VALUE:137,INVALID_ROLE_NAME:139,EXCEEDED_QUOTA:140,INVALID_IMAGE_DATA:150,UNSAVED_FILE_ERROR:151,INVALID_PUSH_TIME_ERROR:152,USERNAME_MISSING:200,PASSWORD_MISSING:201,USERNAME_TAKEN:202,EMAIL_TAKEN:203,EMAIL_MISSING:204,EMAIL_NOT_FOUND:205,SESSION_MISSING:206,MUST_CREATE_USER_THROUGH_SIGNUP:207,ACCOUNT_ALREADY_LINKED:208,LINKED_ID_MISSING:250,INVALID_LINKED_SESSION:251,UNSUPPORTED_SERVICE:252})}(this));(function(){var a=this;var c=(a.NCMB||(a.NCMB={}));var b=/\s+/;var d=Array.prototype.slice;c.Events={on:function(h,l,g){var f,j,i,e,k;if(!l){return this}h=h.split(b);f=this._callbacks||(this._callbacks={});j=h.shift();while(j){k=f[j];i=k?k.tail:{};i.next=e={};i.context=g;i.callback=l;f[j]={tail:e,next:k?k.next:i};j=h.shift()}return this},off:function(l,j,f){var e,m,g,i,h,k;if(!(m=this._callbacks)){return}if(!(l||j||f)){delete this._callbacks;return this}l=l?l.split(b):_.keys(m);e=l.shift();while(e){g=m[e];delete m[e];if(!g||!(j||f)){continue}i=g.tail;g=g.next;while(g!==i){h=g.callback;k=g.context;if((j&&h!==j)||(f&&k!==f)){this.on(e,h,k)}g=g.next}e=l.shift()}return this},trigger:function(h){var l,k,g,f,e,j,i;if(!(g=this._callbacks)){return this}j=g.all;h=h.split(b);i=d.call(arguments,1);l=h.shift();while(l){k=g[l];if(k){f=k.tail;while((k=k.next)!==f){k.callback.apply(k.context||this,i)}}k=j;if(k){f=k.tail;e=[l].concat(i);while((k=k.next)!==f){k.callback.apply(k.context||this,e)}}l=h.shift()}return this}};c.Events.bind=c.Events.on;c.Events.unbind=c.Events.off}.call(this));(function(a){a.NCMB=a.NCMB||{};var c=a.NCMB;var b=c._;c.Object=function(d,e){if(b.isString(d)){return c.Object._create.apply(this,arguments)}d=d||{};if(e&&e.parse){d=this.parse(d)}var f=c._getValue(this,"defaults");if(f){d=b.extend({},f,d)}if(e&&e.collection){this.collection=e.collection}this._serverData={};this._opSetQueue=[{}];this.attributes={};this._hashedJSON={};this._escapedAttributes={};this.cid=b.uniqueId("c");this.changed={};this._silent={};this._pending={};if(!this.set(d,{silent:true})){throw new Error("Can't create an invalid NCMB.Object")}this.changed={};this._silent={};this._pending={};this._hasData=true;this._previousAttributes=b.clone(this.attributes);this.initialize.apply(this,arguments)};c.Object.saveAll=function(e,d){return c.Object._deepSaveAsync(e)._thenRunCallbacks(d)};b.extend(c.Object.prototype,c.Events,{_existed:false,initialize:function(){},toJSON:function(){var d=this._toFullJSON();c._arrayEach(["__type","className"],function(e){delete d[e]});return d},_toFullJSON:function(e){var d=b.clone(this.attributes);c._objectEach(d,function(g,f){d[f]=c._encode(g,e)});c._objectEach(this._operations,function(g,f){d[f]=g});if(b.has(this,"id")){d.objectId=this.id}if(b.has(this,"createdAt")){if(b.isDate(this.createdAt)){d.createdAt=this.createdAt.toJSON()}else{d.createdAt=this.createdAt}}if(b.has(this,"updatedAt")){if(b.isDate(this.updatedAt)){d.updatedAt=this.updatedAt.toJSON()}else{d.updatedAt=this.updatedAt}}d.__type="Object";d.className=this.className;return d},_refreshCache:function(){var d=this;if(d._refreshingCache){return}d._refreshingCache=true;c._objectEach(this.attributes,function(f,e){if(f instanceof c.Object){f._refreshCache()}else{if(b.isObject(f)){if(d._resetCacheForKey(e)){d.set(e,new c.Op.Set(f),{silent:true})}}}});delete d._refreshingCache},dirty:function(e){this._refreshCache();var d=b.last(this._opSetQueue);if(e){return(d[e]?true:false)}if(!this.id){return true}if(b.keys(d).length>0){return true}return false},_toPointer:function(){if(!this.id){throw new Error("Can't serialize an unsaved NCMB.Object")}return{__type:"Pointer",className:this.className,objectId:this.id}},get:function(d){return this.attributes[d]},relation:function(d){var e=this.get(d);if(e){if(!(e instanceof c.Relation)){throw"Called relation() on non-relation field "+d}e._ensureParentAndKey(this,d);return e}else{return new c.Relation(this,d)}},escape:function(e){var d=this._escapedAttributes[e];if(d){return d}var g=this.attributes[e];var f;if(c._isNullOrUndefined(g)){f=""}else{f=b.escape(g.toString())}this._escapedAttributes[e]=f;return f},has:function(d){return !c._isNullOrUndefined(this.attributes[d])},_mergeMagicFields:function(e){var d=this;var f=["id","objectId","createdAt","updatedAt"];c._arrayEach(f,function(g){if(e[g]){if(g==="objectId"){d.id=e[g]}else{if((g==="createdAt"||g==="updatedAt")&&!b.isDate(e[g])){d[g]=c._NCMBDate(e[g])}else{d[g]=e[g]}}delete e[g]}})},_startSave:function(){this._opSetQueue.push({})},_cancelSave:function(){var e=this;var d=b.first(this._opSetQueue);this._opSetQueue=b.rest(this._opSetQueue);var f=b.first(this._opSetQueue);c._objectEach(d,function(j,h){var i=d[h];var g=f[h];if(i&&g){f[h]=g._mergeWithPrevious(i)}else{if(i){f[h]=i}}});this._saving=this._saving-1},_finishSave:function(f){var d={};c._traverse(this.attributes,function(h){if(h instanceof c.Object&&h.id&&h._hasData){d[h.id]=h}});var g=b.first(this._opSetQueue);this._opSetQueue=b.rest(this._opSetQueue);this._applyOpSet(g,this._serverData);this._mergeMagicFields(f);var e=this;c._objectEach(f,function(i,h){e._serverData[h]=c._decode(h,i);var j=c._traverse(e._serverData[h],function(k){if(k instanceof c.Object&&d[k.id]){return d[k.id]}});if(j){e._serverData[h]=j}});this._rebuildAllEstimatedData();this._saving=this._saving-1},_finishFetch:function(f,e){this._opSetQueue=[{}];this._mergeMagicFields(f);var d=this;c._objectEach(f,function(h,g){d._serverData[g]=c._decode(g,h)});this._rebuildAllEstimatedData();this._refreshCache();this._opSetQueue=[{}];this._hasData=e},_applyOpSet:function(e,f){var d=this;c._objectEach(e,function(h,g){f[g]=h._estimate(f[g],d,g);if(f[g]===c.Op._UNSET){delete f[g]}})},_resetCacheForKey:function(e){var f=this.attributes[e];if(b.isObject(f)&&!(f instanceof c.Object)&&!(f instanceof c.File)){f=f.toJSON?f.toJSON():f;var d=JSON.stringify(f);if(this._hashedJSON[e]!==d){this._hashedJSON[e]=d;return true}}return false},_rebuildEstimatedDataForKey:function(e){var d=this;delete this.attributes[e];if(this._serverData[e]){this.attributes[e]=this._serverData[e]}c._arrayEach(this._opSetQueue,function(f){var g=f[e];if(g){d.attributes[e]=g._estimate(d.attributes[e],d,e);if(d.attributes[e]===c.Op._UNSET){delete d.attributes[e]}else{d._resetCacheForKey(e)}}})},_rebuildAllEstimatedData:function(){var d=this;var e=b.clone(this.attributes);this.attributes=b.clone(this._serverData);c._arrayEach(this._opSetQueue,function(f){d._applyOpSet(f,d.attributes);c._objectEach(f,function(h,g){d._resetCacheForKey(g)})});c._objectEach(e,function(f,g){if(d.attributes[g]!==f){d.trigger("change:"+g,d,d.attributes[g],{})}});c._objectEach(this.attributes,function(g,f){if(!b.has(e,f)){d.trigger("change:"+f,d,g,{})}})},set:function(i,h,l){var j,g;if(b.isObject(i)||c._isNullOrUndefined(i)){j=i;c._objectEach(j,function(n,m){j[m]=c._decode(m,n)});l=h}else{j={};j[i]=c._decode(i,h)}l=l||{};if(!j){return this}if(j instanceof c.Object){j=j.attributes}if(l.unset){c._objectEach(j,function(m,n){j[n]=new c.Op.Unset()})}var f=b.clone(j);var k=this;c._objectEach(f,function(m,n){if(m instanceof c.Op){f[n]=m._estimate(k.attributes[n],k,n);if(f[n]===c.Op._UNSET){delete f[n]}}});if(!this._validate(j,l)){return false}this._mergeMagicFields(j);l.changes={};var d=this._escapedAttributes;var e=this._previousAttributes||{};c._arrayEach(b.keys(j),function(n){var p=j[n];if(p instanceof c.Relation){p.parent=k}if(!(p instanceof c.Op)){p=new c.Op.Set(p)}var m=true;if(p instanceof c.Op.Set&&b.isEqual(k.attributes[n],p.value)){m=false}if(m){delete d[n];if(l.silent){k._silent[n]=true}else{l.changes[n]=true}}var o=b.last(k._opSetQueue);o[n]=p._mergeWithPrevious(o[n]);k._rebuildEstimatedDataForKey(n);if(m){k.changed[n]=k.attributes[n];if(!l.silent){k._pending[n]=true}}else{delete k.changed[n];delete k._pending[n]}});if(!l.silent){this.change(l)}return this},unset:function(e,d){d=d||{};return this.set(e,null,d)},increment:function(e,d){if(b.isUndefined(d)||b.isNull(d)){d=1}return this.set(e,new c.Op.Increment(d))},add:function(d,e){return this.set(d,new c.Op.Add([e]))},addUnique:function(d,e){return this.set(d,new c.Op.AddUnique([e]))},remove:function(d,e){return this.set(d,new c.Op.Remove([e]))},op:function(d){return b.last(this._opSetQueue)[d]},clear:function(d){d=d||{};d.unset=true;var e=b.extend(this.attributes,this._operations);return this.set(e,d)},_getSaveJSON:function(){var d=b.clone(b.first(this._opSetQueue));c._objectEach(d,function(f,e){d[e]=f.toJSON()});return d},_canBeSerialized:function(){return c.Object._canBeSerializedAsValue(this.attributes)},fetch:function(e){var d=this;var f=c._request("classes",this.className,this.id,"GET");return f.then(function(h,g,i){d._finishFetch(d.parse(h,g,i),true);return d})._thenRunCallbacks(e,this)},save:function(o,q){var f,m,h,l;m=o;if(!q&&m){var n=b.reject(m,function(r,i){return b.include(["success","error","wait"],i)});if(n.length===0){var p=true;if(b.has(m,"success")&&!b.isFunction(m.success)){p=false}if(b.has(m,"error")&&!b.isFunction(m.error)){p=false}if(p){return this.save(null,m)}}}q=b.clone(q)||{};if(q.wait){h=b.clone(this.attributes)}var j=b.clone(q)||{};if(j.wait){j.silent=true}var e;j.error=function(r,i){e=i};if(m&&!this.set(m,j)){return c.Promise.error(e)._thenRunCallbacks(q,this)}var g=this;g._refreshCache();var k=[];var d=[];c.Object._findUnsavedChildren(g.attributes,k,d);if(k.length+d.length>0){return c.Object._deepSaveAsync(this.attributes).then(function(){return g.save(null,q)},function(i){return c.Promise.error(i)._thenRunCallbacks(q,g)})}this._startSave();this._saving=(this._saving||0)+1;this._allPreviousSaves=this._allPreviousSaves||c.Promise.as();this._allPreviousSaves=this._allPreviousSaves._continueWith(function(){var u=g.id?"PUT":"POST";var r=g._getSaveJSON();var i="classes";var s=g.className;var t=c._request(i,s,g.id,u,r);t=t.then(function(y,v,x){var w=g.parse(y,v,x);if(q.wait){w=b.extend(m||{},w)}g._finishSave(w);if(q.wait){g.set(h,j)}return g},function(v){g._cancelSave();return c.Promise.error(v)})._thenRunCallbacks(q,g);return t});return this._allPreviousSaves},destroy:function(f){f=f||{};var e=this;var h=function(){e.trigger("destroy",e,e.collection,f)};if(!this.id){var d=this.get("fileName");if(d){this.id=d}else{return h()}}if(!f.wait){h()}var g=c._request("classes",this.className,this.id,"DELETE");return g.then(function(){if(f.wait){h()}return e})._thenRunCallbacks(f,this)},parse:function(g,d,f){var e=b.clone(g);b(["createdAt","updatedAt"]).each(function(h){if(e[h]){e[h]=c._NCMBDate(e[h])}});if(!e.updatedAt){e.updatedAt=e.createdAt}if(d){this._existed=(d!==201)}return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return !this.id},change:function(f){f=f||{};var h=this._changing;this._changing=true;var e=this;c._objectEach(this._silent,function(i){e._pending[i]=true});var g=b.extend({},f.changes,this._silent);this._silent={};c._objectEach(g,function(j,i){e.trigger("change:"+i,e,e.get(i),f)});if(h){return this}var d=function(j,i){if(!e._pending[i]&&!e._silent[i]){delete e.changed[i]}};while(!b.isEmpty(this._pending)){this._pending={};this.trigger("change",this,f);c._objectEach(this.changed,d);e._previousAttributes=b.clone(this.attributes)}this._changing=false;return this},existed:function(){return this._existed},changedAttributes:function(e){if(!e){return this.hasChanged()?b.clone(this.changed):false}var f={};var d=this._previousAttributes;c._objectEach(e,function(h,g){if(!b.isEqual(d[g],h)){f[g]=h}});return f},previous:function(d){if(!arguments.length||!this._previousAttributes){return null}return this._previousAttributes[d]},previousAttributes:function(){return b.clone(this._previousAttributes)},isValid:function(){return !this.validate(this.attributes)},validate:function(e,d){if(b.has(e,"ACL")&&!(e.ACL instanceof c.ACL)){return new c.Error(c.Error.OTHER_CAUSE,"ACL must be a NCMB.ACL.")}return false},_validate:function(f,e){if(e.silent||!this.validate){return true}f=b.extend({},this.attributes,f);var d=this.validate(f,e);if(!d){return true}if(e&&e.error){e.error(this,d,e)}else{this.trigger("error",this,d,e)}return false},getACL:function(){return this.get("acl")},setACL:function(e,d){return this.set("acl",e,d)}});c.Object._getSubclass=function(e){if(!b.isString(e)){throw"NCMB.Object._getSubclass requires a string argument."}var d=c.Object._classMap[e];if(!d){d=c.Object.extend(e);c.Object._classMap[e]=d}return d};c.Object._create=function(g,d,e){var f=c.Object._getSubclass(g);return new f(d,e)};c.Object._classMap={};c.Object._extend=c._extend;c.Object.extend=function(g,f,h){if(!b.isString(g)){if(g&&b.has(g,"className")){return c.Object.extend(g.className,g,f)}else{throw new Error("NCMB.Object.extend's first argument should be the className.")}}if(g==="User"){classname="user"}var d=null;if(b.has(c.Object._classMap,g)){var e=c.Object._classMap[g];d=e._extend(f,h)}else{f=f||{};f.className=g;d=this._extend(f,h)}d.extend=function(j){if(b.isString(j)||(j&&b.has(j,"className"))){return c.Object.extend.apply(d,arguments)}var i=[g].concat(c._.toArray(arguments));return c.Object.extend.apply(d,i)};c.Object._classMap[g]=d;return d};c.Object._findUnsavedChildren=function(d,e,f){c._traverse(d,function(g){if(g instanceof c.Object){g._refreshCache();if(g.dirty()){e.push(g)}return}if(g instanceof c.File){if(!g.url()){f.push(g)}return}})};c.Object._canBeSerializedAsValue=function(d){var e=true;if(d instanceof c.Object){e=!!d.id}else{if(b.isArray(d)){c._arrayEach(d,function(f){if(!c.Object._canBeSerializedAsValue(f)){e=false}})}else{if(b.isObject(d)){c._objectEach(d,function(f){if(!c.Object._canBeSerializedAsValue(f)){e=false}})}}}return e};c.Object._deepSaveAsync=function(e){var d=[];var h=[];c.Object._findUnsavedChildren(e,d,h);var i=c.Promise.as();b.each(h,function(j){i=i.then(function(){return j.save()})});var g=b.uniq(d);var f=b.uniq(g);return i.then(function(){return c.Promise._continueWhile(function(){return f.length>0},function(){var m=[];var j=[];c._arrayEach(f,function(n){if(m.length>20){j.push(n);return}if(n._canBeSerialized()){m.push(n)}else{j.push(n)}});f=j;if(m.length===0){return c.Promise.error(new c.Error(c.Error.OTHER_CAUSE,"Tried to save a batch with a cycle."))}var k=c.Promise.when(b.map(m,function(n){return n._allPreviousSaves||c.Promise.as()}));var l=new c.Promise();c._arrayEach(m,function(n){n._allPreviousSaves=l});return k._continueWith(function(){return c._request("batch",null,null,"POST",{requests:b.map(m,function(n){var o=n._getSaveJSON();var q="POST";var p="/2013-09-01/classes/"+n.className;if(n.id){p=p+"/"+n.id;q="PUT"}n._startSave();return{method:q,path:p,body:o}})}).then(function(o,n,q){var p;c._arrayEach(m,function(r,s){if(o[s].success){r._finishSave(r.parse(o[s].success,n,q))}else{p=p||o[s].error;r._cancelSave()}});if(p){return c.Promise.error(new c.Error(p.code,p.error))}}).then(function(n){l.resolve(n);return n},function(n){l.reject(n);return c.Promise.error(n)})})})}).then(function(){return e})}}(this));(function(a){a.NCMB=a.NCMB||{};var c=a.NCMB;var b=c._;c.Relation=function(e,d){this.parent=e;this.key=d;this.targetClassName=null};c.Relation.prototype={_ensureParentAndKey:function(e,d){this.parent=this.parent||e;this.key=this.key||d;if(this.parent!==e){throw"Internal Error. Relation retrieved from two different Objects."}if(this.key!==d){throw"Internal Error. Relation retrieved from two different keys."}},add:function(d){if(!b.isArray(d)){d=[d]}var e=new c.Op.Relation(d,[]);this.parent.set(this.key,e);this.targetClassName=e._targetClassName},remove:function(d){if(!b.isArray(d)){d=[d]}var e=new c.Op.Relation([],d);this.parent.set(this.key,e);this.targetClassName=e._targetClassName},toJSON:function(){return{__type:"Relation",className:this.targetClassName}},query:function(){var d;var e;if(!this.targetClassName){d=c.Object._getSubclass(this.parent.className);e=new c.Query(d);e._extraOptions.redirectClassNameForKey=this.key}else{d=c.Object._getSubclass(this.targetClassName);e=new c.Query(d)}e._addCondition("$relatedTo","object",this.parent._toPointer());e._addCondition("$relatedTo","key",this.key);return e}}}(this));(function(a){a.NCMB=a.NCMB||{};var c=a.NCMB;var b=c._;c.Op=function(){this._initialize.apply(this,arguments)};c.Op.prototype={_initialize:function(){}};b.extend(c.Op,{_extend:c._extend,_opDecoderMap:{},_registerDecoder:function(d,e){c.Op._opDecoderMap[d]=e},_decode:function(d){var e=c.Op._opDecoderMap[d.__op];if(e){return e(d)}else{return undefined}}});c.Op._registerDecoder("Batch",function(d){var e=null;c._arrayEach(d.ops,function(f){f=c.Op._decode(f);e=f._mergeWithPrevious(e)});return e});c.Op.Set=c.Op._extend({_initialize:function(d){this._value=d},value:function(){return this._value},toJSON:function(){return c._encode(this.value())},_mergeWithPrevious:function(d){return this},_estimate:function(d){return this.value()}});c.Op._UNSET={};c.Op.Unset=c.Op._extend({toJSON:function(){return{__op:"Unset"}},_mergeWithPrevious:function(d){return this},_estimate:function(d){return c.Op._UNSET}});c.Op._registerDecoder("Delete",function(d){return new c.Op.Unset()});c.Op.Increment=c.Op._extend({_initialize:function(d){this._amount=d},amount:function(){return this._amount},toJSON:function(){return{__op:"Increment",amount:this._amount}},_mergeWithPrevious:function(d){if(!d){return this}else{if(d instanceof c.Op.Unset){return new c.Op.Set(this.amount())}else{if(d instanceof c.Op.Set){return new c.Op.Set(d.value()+this.amount())}else{if(d instanceof c.Op.Increment){return new c.Op.Increment(this.amount()+d.amount())}else{throw"Op is invalid after previous op."}}}}},_estimate:function(d){if(!d){return this.amount()}return d+this.amount()}});c.Op._registerDecoder("Increment",function(d){return new c.Op.Increment(d.amount)});c.Op.Add=c.Op._extend({_initialize:function(d){this._objects=d},objects:function(){return this._objects},toJSON:function(){return{__op:"Add",objects:c._encode(this.objects())}},_mergeWithPrevious:function(d){if(!d){return this}else{if(d instanceof c.Op.Unset){return new c.Op.Set(this.objects())}else{if(d instanceof c.Op.Set){return new c.Op.Set(this._estimate(d.value()))}else{if(d instanceof c.Op.Add){return new c.Op.Add(d.objects().concat(this.objects()))}else{throw"Op is invalid after previous op."}}}}},_estimate:function(d){if(!d){return b.clone(this.objects())}else{return d.concat(this.objects())}}});c.Op._registerDecoder("Add",function(d){return new c.Op.Add(c._decode(undefined,d.objects))});c.Op.AddUnique=c.Op._extend({_initialize:function(d){this._objects=b.uniq(d)},objects:function(){return this._objects},toJSON:function(){return{__op:"AddUnique",objects:c._encode(this.objects())}},_mergeWithPrevious:function(d){if(!d){return this}else{if(d instanceof c.Op.Unset){return new c.Op.Set(this.objects())}else{if(d instanceof c.Op.Set){return new c.Op.Set(this._estimate(d.value()))}else{if(d instanceof c.Op.AddUnique){return new c.Op.AddUnique(this._estimate(d.objects()))}else{throw"Op is invalid after previous op."}}}}},_estimate:function(d){if(!d){return b.clone(this.objects())}else{var e=b.clone(d);c._arrayEach(this.objects(),function(h){if(h instanceof c.Object&&h.id){var g=b.find(e,function(i){return(i instanceof c.Object)&&(i.id===h.id)});if(!g){e.push(h)}else{var f=b.indexOf(e,g);e[f]=h}}else{if(!b.contains(e,h)){e.push(h)}}});return e}}});c.Op._registerDecoder("AddUnique",function(d){return new c.Op.AddUnique(c._decode(undefined,d.objects))});c.Op.Remove=c.Op._extend({_initialize:function(d){this._objects=b.uniq(d)},objects:function(){return this._objects},toJSON:function(){return{__op:"Remove",objects:c._encode(this.objects())}},_mergeWithPrevious:function(d){if(!d){return this}else{if(d instanceof c.Op.Unset){return d}else{if(d instanceof c.Op.Set){return new c.Op.Set(this._estimate(d.value()))}else{if(d instanceof c.Op.Remove){return new c.Op.Remove(b.union(d.objects(),this.objects()))}else{throw"Op is invalid after previous op."}}}}},_estimate:function(d){if(!d){return[]}else{var e=b.difference(d,this.objects());c._arrayEach(this.objects(),function(f){if(f instanceof c.Object&&f.id){e=b.reject(e,function(g){return(g instanceof c.Object)&&(g.id===f.id)})}});return e}}});c.Op._registerDecoder("Remove",function(d){return new c.Op.Remove(c._decode(undefined,d.objects))});c.Op.Relation=c.Op._extend({_initialize:function(g,e){this._targetClassName=null;var d=this;var f=function(h){if(h instanceof c.Object){if(!h.id){throw"You can't add an unsaved NCMB.Object to a relation."}if(!d._targetClassName){d._targetClassName=h.className}if(d._targetClassName!==h.className){throw"Tried to create a NCMB.Relation with 2 different types: "+d._targetClassName+" and "+h.className+"."}return h.id}return h};this.relationsToAdd=b.uniq(b.map(g,f));this.relationsToRemove=b.uniq(b.map(e,f))},added:function(){var d=this;return b.map(this.relationsToAdd,function(e){var f=c.Object._create(d._targetClassName);f.id=e;return f})},removed:function(){var d=this;return b.map(this.relationsToRemove,function(e){var f=c.Object._create(d._targetClassName);f.id=e;return f})},toJSON:function(){var h=null;var f=null;var e=this;var g=function(i){return{__type:"Pointer",className:e._targetClassName,objectId:i}};var d=null;if(this.relationsToAdd.length>0){d=b.map(this.relationsToAdd,g);h={__op:"AddRelation",objects:d}}if(this.relationsToRemove.length>0){d=b.map(this.relationsToRemove,g);f={__op:"RemoveRelation",objects:d}}if(h&&f){return{__op:"Batch",ops:[h,f]}}return h||f||{}},_mergeWithPrevious:function(g){if(!g){return this}else{if(g instanceof c.Op.Unset){throw"You can't modify a relation after deleting it."}else{if(g instanceof c.Op.Relation){if(g._targetClassName&&g._targetClassName!==this._targetClassName){throw"Related object must be of class "+g._targetClassName+", but "+this._targetClassName+" was passed in."}var f=b.union(b.difference(g.relationsToAdd,this.relationsToRemove),this.relationsToAdd);var e=b.union(b.difference(g.relationsToRemove,this.relationsToAdd),this.relationsToRemove);var d=new c.Op.Relation(f,e);d._targetClassName=this._targetClassName;return d}else{throw"Op is invalid after previous op."}}}},_estimate:function(e,d,f){if(!e){var g=new c.Relation(d,f);g.targetClassName=this._targetClassName}else{if(e instanceof c.Relation){if(this._targetClassName){if(e.targetClassName){if(e.targetClassName!==this._targetClassName){throw"Related object must be a "+e.targetClassName+", but a "+this._targetClassName+" was passed in."}}else{e.targetClassName=this._targetClassName}}return e}else{throw"Op is invalid after previous op."}}}});c.Op._registerDecoder("AddRelation",function(d){return new c.Op.Relation(c._decode(undefined,d.objects),[])});c.Op._registerDecoder("RemoveRelation",function(d){return new c.Op.Relation([],c._decode(undefined,d.objects))})}(this));(function(b){b.NCMB=b.NCMB||{};var e=b.NCMB;var d=e._;var c=function(h){if(h<26){return String.fromCharCode(65+h)}if(h<52){return String.fromCharCode(97+(h-26))}if(h<62){return String.fromCharCode(48+(h-52))}if(h===62){return"+"}if(h===63){return"/"}throw"Tried to encode large digit "+h+" in base64."};var a=function(i){var h=[];h.length=Math.ceil(i.length/3);d.times(h.length,function(m){var l=i[m*3];var k=i[m*3+1]||0;var j=i[m*3+2]||0;var o=(m*3+1)<i.length;var n=(m*3+2)<i.length;h[m]=[c((l>>2)&63),c(((l<<4)&48)|((k>>4)&15)),o?c(((k<<2)&60)|((j>>6)&3)):"=",n?c(j&63):"="].join("")});return h.join("")};var g={ai:"application/postscript",aif:"audio/x-aiff",aifc:"audio/x-aiff",aiff:"audio/x-aiff",asc:"text/plain",atom:"application/atom+xml",au:"audio/basic",avi:"video/x-msvideo",bcpio:"application/x-bcpio",bin:"application/octet-stream",bmp:"image/bmp",cdf:"application/x-netcdf",cgm:"image/cgm","class":"application/octet-stream",cpio:"application/x-cpio",cpt:"application/mac-compactpro",csh:"application/x-csh",css:"text/css",dcr:"application/x-director",dif:"video/x-dv",dir:"application/x-director",djv:"image/vnd.djvu",djvu:"image/vnd.djvu",dll:"application/octet-stream",dmg:"application/octet-stream",dms:"application/octet-stream",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",docm:"application/vnd.ms-word.document.macroEnabled.12",dotm:"application/vnd.ms-word.template.macroEnabled.12",dtd:"application/xml-dtd",dv:"video/x-dv",dvi:"application/x-dvi",dxr:"application/x-director",eps:"application/postscript",etx:"text/x-setext",exe:"application/octet-stream",ez:"application/andrew-inset",gif:"image/gif",gram:"application/srgs",grxml:"application/srgs+xml",gtar:"application/x-gtar",hdf:"application/x-hdf",hqx:"application/mac-binhex40",htm:"text/html",html:"text/html",ice:"x-conference/x-cooltalk",ico:"image/x-icon",ics:"text/calendar",ief:"image/ief",ifb:"text/calendar",iges:"model/iges",igs:"model/iges",jnlp:"application/x-java-jnlp-file",jp2:"image/jp2",jpe:"image/jpeg",jpeg:"image/jpeg",jpg:"image/jpeg",js:"application/x-javascript",kar:"audio/midi",latex:"application/x-latex",lha:"application/octet-stream",lzh:"application/octet-stream",m3u:"audio/x-mpegurl",m4a:"audio/mp4a-latm",m4b:"audio/mp4a-latm",m4p:"audio/mp4a-latm",m4u:"video/vnd.mpegurl",m4v:"video/x-m4v",mac:"image/x-macpaint",man:"application/x-troff-man",mathml:"application/mathml+xml",me:"application/x-troff-me",mesh:"model/mesh",mid:"audio/midi",midi:"audio/midi",mif:"application/vnd.mif",mov:"video/quicktime",movie:"video/x-sgi-movie",mp2:"audio/mpeg",mp3:"audio/mpeg",mp4:"video/mp4",mpe:"video/mpeg",mpeg:"video/mpeg",mpg:"video/mpeg",mpga:"audio/mpeg",ms:"application/x-troff-ms",msh:"model/mesh",mxu:"video/vnd.mpegurl",nc:"application/x-netcdf",oda:"application/oda",ogg:"application/ogg",pbm:"image/x-portable-bitmap",pct:"image/pict",pdb:"chemical/x-pdb",pdf:"application/pdf",pgm:"image/x-portable-graymap",pgn:"application/x-chess-pgn",pic:"image/pict",pict:"image/pict",png:"image/png",pnm:"image/x-portable-anymap",pnt:"image/x-macpaint",pntg:"image/x-macpaint",ppm:"image/x-portable-pixmap",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",potx:"application/vnd.openxmlformats-officedocument.presentationml.template",ppsx:"application/vnd.openxmlformats-officedocument.presentationml.slideshow",ppam:"application/vnd.ms-powerpoint.addin.macroEnabled.12",pptm:"application/vnd.ms-powerpoint.presentation.macroEnabled.12",potm:"application/vnd.ms-powerpoint.template.macroEnabled.12",ppsm:"application/vnd.ms-powerpoint.slideshow.macroEnabled.12",ps:"application/postscript",qt:"video/quicktime",qti:"image/x-quicktime",qtif:"image/x-quicktime",ra:"audio/x-pn-realaudio",ram:"audio/x-pn-realaudio",ras:"image/x-cmu-raster",rdf:"application/rdf+xml",rgb:"image/x-rgb",rm:"application/vnd.rn-realmedia",roff:"application/x-troff",rtf:"text/rtf",rtx:"text/richtext",sgm:"text/sgml",sgml:"text/sgml",sh:"application/x-sh",shar:"application/x-shar",silo:"model/mesh",sit:"application/x-stuffit",skd:"application/x-koan",skm:"application/x-koan",skp:"application/x-koan",skt:"application/x-koan",smi:"application/smil",smil:"application/smil",snd:"audio/basic",so:"application/octet-stream",spl:"application/x-futuresplash",src:"application/x-wais-source",sv4cpio:"application/x-sv4cpio",sv4crc:"application/x-sv4crc",svg:"image/svg+xml",swf:"application/x-shockwave-flash",t:"application/x-troff",tar:"application/x-tar",tcl:"application/x-tcl",tex:"application/x-tex",texi:"application/x-texinfo",texinfo:"application/x-texinfo",tif:"image/tiff",tiff:"image/tiff",tr:"application/x-troff",tsv:"text/tab-separated-values",txt:"text/plain",ustar:"application/x-ustar",vcd:"application/x-cdlink",vrml:"model/vrml",vxml:"application/voicexml+xml",wav:"audio/x-wav",wbmp:"image/vnd.wap.wbmp",wbmxl:"application/vnd.wap.wbxml",wml:"text/vnd.wap.wml",wmlc:"application/vnd.wap.wmlc",wmls:"text/vnd.wap.wmlscript",wmlsc:"application/vnd.wap.wmlscriptc",wrl:"model/vrml",xbm:"image/x-xbitmap",xht:"application/xhtml+xml",xhtml:"application/xhtml+xml",xls:"application/vnd.ms-excel",xml:"application/xml",xpm:"image/x-xpixmap",xsl:"application/xml",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.12",xltm:"application/vnd.ms-excel.template.macroEnabled.12",xlam:"application/vnd.ms-excel.addin.macroEnabled.12",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.12",xslt:"application/xslt+xml",xul:"application/vnd.mozilla.xul+xml",xwd:"image/x-xwindowdump",xyz:"chemical/x-xyz",zip:"application/zip"};var f=function(i,j){var k=new e.Promise();if(typeof(FileReader)==="undefined"){return e.Promise.error(new e.Error(-1,"Attempted to use a FileReader on an unsupported browser."))}var h=new FileReader();h.onloadend=function(){if(h.readyState!==2){k.reject(new e.Error(-1,"Error reading file."));return}var m=h.result;var p=/\.([^.]*)$/.exec(i.name);if(p){p=p[1].toLowerCase()}var o=j||g[p]||"text/plain";if(m==="data:"){if(j){m="data:"+j+";base64,"}else{m="data:"+o+";base64,"}}var l=/^data:([^;]*);base64,(.*)$/.exec(m);var n=/^data:base64,(.*)$/.exec(m);if(!l){if(!n){k.reject(new e.Error(-1,"Unable to interpret data URL: "+m));return}else{k.resolve(n[1],j||o)}}else{k.resolve(l[2],j||l[1])}};h.readAsDataURL(i);return k};e.File=e.Object.extend("File",{constructor:function(h,j,i,k){this._name=h;this._data=j;this._type=i;if(d.isString(h)&&(k instanceof e.ACL)){e.Object.prototype.constructor.call(this,null,null);this.ACL=k}else{e.Object.prototype.constructor.call(this,h,j,i,k)}var m=/\.([^.]*)$/.exec(h);if(m){m=m[1].toLowerCase()}var l=i||g[m]||"text/plain";if(!i){this._type=l}if(d.isArray(j)){this._source=e.Promise.as(a(j),l)}else{if(j&&j.base64){this._source=e.Promise.as(j.base64,l)}else{if(typeof(File)!=="undefined"&&j instanceof File){this._source=f(j,i)}else{if(d.isString(j)){throw"Creating a NCMB.File from a String is not yet supported."}}}}},getName:function(){return this._name},save:function(i){var h=this;if(!h._previousSave){h._previousSave=h._source.then(function(j,k){h._dataBase64=j;var l={};l.file=h._data;if(h.ACL){l.acl=JSON.stringify(h.ACL)}else{l.acl=JSON.stringify({"*":{read:true,write:true}})}return e._request("files",h._name,null,"POST",l)}).then(function(j){h._name=j.fileName;return h})}return h._previousSave._thenRunCallbacks(i)},_destroy:function(i){i=i||{};var h=this;var k=function(){h.trigger("destroy",h,h.collection,i)};var j=e._request("files",self._name,null,"DELETE");return j.then(function(){if(i.wait){k()}return h})._thenRunCallbacks(i,this)},_fetch:function(h){},_getContentType:function(){return this._type},_getData:function(h){return this._data}})}(this));(function(a){a.NCMB=a.NCMB||{};var d=a.NCMB;var c=d._;var b="*";d.ACL=function(f){var e=this;e.permissionsById={};if(c.isObject(f)){if(f instanceof d.User){e.setReadAccess(f,true);e.setWriteAccess(f,true)}else{if(c.isFunction(f)){throw"NCMB.ACL() called with a function.  Did you forget ()?"}d._objectEach(f,function(h,g){if(!c.isString(g)){throw"Tried to create an ACL with an invalid userId."}e.permissionsById[g]={};d._objectEach(h,function(j,i){if(i!=="read"&&i!=="write"){throw"Tried to create an ACL with an invalid permission type."}if(!c.isBoolean(j)){throw"Tried to create an ACL with an invalid permission value."}e.permissionsById[g][i]=j})})}}};d.ACL.prototype.toJSON=function(){return c.clone(this.permissionsById)};d.ACL.prototype._setAccess=function(e,f,h){if(f instanceof d.User){f=f.id}else{if(f instanceof d.Role){f="role:"+f.getName()}}if(!c.isString(f)){throw"userId must be a string."}if(!c.isBoolean(h)){throw"allowed must be either true or false."}var g=this.permissionsById[f];if(!g){if(!h){return}else{g={};this.permissionsById[f]=g}}if(h){this.permissionsById[f][e]=true}else{delete g[e];if(c.isEmpty(g)){delete g[f]}}};d.ACL.prototype._getAccess=function(e,f){if(f instanceof d.User){f=f.id}else{if(f instanceof d.Role){f="role:"+f.getName()}}var g=this.permissionsById[f];if(!g){return false}return g[e]?true:false};d.ACL.prototype.setReadAccess=function(e,f){this._setAccess("read",e,f)};d.ACL.prototype.getReadAccess=function(e){return this._getAccess("read",e)};d.ACL.prototype.setWriteAccess=function(e,f){this._setAccess("write",e,f)};d.ACL.prototype.getWriteAccess=function(e){return this._getAccess("write",e)};d.ACL.prototype.setPublicReadAccess=function(e){this.setReadAccess(b,e)};d.ACL.prototype.getPublicReadAccess=function(){return this.getReadAccess(b)};d.ACL.prototype.setPublicWriteAccess=function(e){this.setWriteAccess(b,e)};d.ACL.prototype.getPublicWriteAccess=function(){return this.getWriteAccess(b)};d.ACL.prototype.getRoleReadAccess=function(e){if(e instanceof d.Role){e=e.getName()}if(c.isString(e)){return this.getReadAccess("role:"+e)}throw"role must be a NCMB.Role or a String"};d.ACL.prototype.getRoleWriteAccess=function(e){if(e instanceof d.Role){e=e.getName()}if(c.isString(e)){return this.getWriteAccess("role:"+e)}throw"role must be a NCMB.Role or a String"};d.ACL.prototype.setRoleReadAccess=function(f,e){if(f instanceof d.Role){f=f.getName()}if(c.isString(f)){this.setReadAccess("role:"+f,e);return}throw"role must be a NCMB.Role or a String"};d.ACL.prototype.setRoleWriteAccess=function(f,e){if(f instanceof d.Role){f=f.getName()}if(c.isString(f)){this.setWriteAccess("role:"+f,e);return}throw"role must be a NCMB.Role or a String"}}(this));(function(a){a.NCMB=a.NCMB||{};var c=a.NCMB;var b=c._;c.Role=c.Object.extend("role",{constructor:function(d,e){if(b.isString(d)&&(e instanceof c.ACL)){c.Object.prototype.constructor.call(this,null,null);this.setName(d);this.setACL(e)}else{c.Object.prototype.constructor.call(this,d,e)}},getName:function(){return this.get("roleName")},setName:function(e,d){return this.set("roleName",e,d)},_setRoles:function(e,d){return this.set("belongRole",e,d)},_setUsers:function(e,d){return this.set("belongUser",e,d)},getUsers:function(){return this.relation("belongUser")},getRoles:function(){return this.relation("belongRole")},validate:function(f,e){if("roleName" in f&&f.roleName!==this.getName()){var d=f.roleName;if(this.id&&this.id!==f.objectId){return new c.Error(c.Error.OTHER_CAUSE,"A role's name can only be set before it has been saved.")}if(!b.isString(d)){return new c.Error(c.Error.OTHER_CAUSE,"A role's name must be a String.")}if(!(/^[0-9a-zA-Z\-_ ]+$/).test(d)){return new c.Error(c.Error.OTHER_CAUSE,"A role's name can only contain alphanumeric characters, _, -, and spaces.")}}if(c.Object.prototype.validate){return c.Object.prototype.validate.call(this,f,e)}return false}})}(this));(function(a){a.NCMB=a.NCMB||{};var c=a.NCMB;var b=c._;c.Query=function(d){if(b.isString(d)){d=c.Object._getSubclass(d)}this.objectClass=d;this.className=d.prototype.className;this._where={};this._include=[];this._limit=-1;this._skip=0;this._extraOptions={}};c.Query.or=function(d){var d=b.toArray(arguments);var e=null;c._arrayEach(d,function(g){if(b.isNull(e)){e=g.className}if(e!==g.className){throw"All queries must be for the same class"}});var f=new c.Query(e);f._orQuery(d);return f};c.Query.prototype={get:function(d,f){var e=this;e.equalTo("objectId",d);return e.first().then(function(g){if(g){return g}var h=new c.Error(c.Error.OBJECT_NOT_FOUND,"Object not found.");return c.Promise.error(h)})._thenRunCallbacks(f,null)},toJSON:function(){var d={where:this._where};if(this._include.length>0){d.include=this._include.join(",")}if(this._select){d.keys=this._select.join(",")}if(this._limit>=0){d.limit=this._limit}if(this._skip>0){d.skip=this._skip}if(this._order!==undefined){d.order=this._order}c._objectEach(this._extraOptions,function(f,e){d[e]=f});return d},find:function(e){var d=this;var f=c._request("classes",this.className,null,"GET",this.toJSON());return f.then(function(g){return b.map(g.results,function(h){var i;if(g.className){i=new c.Object(g.className)}else{i=new d.objectClass()}i._finishFetch(h,true);return i})})._thenRunCallbacks(e)},count:function(d){var f=this.toJSON();f.limit=0;f.count=1;var e=c._request("classes",this.className,null,"GET",f);return e.then(function(g){return g.count})._thenRunCallbacks(d)},first:function(e){var d=this;var g=this.toJSON();g.limit=1;var f=c._request("classes",this.className,null,"GET",g);return f.then(function(h){return b.map(h.results,function(i){var j=new d.objectClass();j._finishFetch(i,true);return j})[0]})._thenRunCallbacks(e)},collection:function(d,e){e=e||{};return new c.Collection(d,b.extend(e,{model:this.objectClass,query:this}))},skip:function(d){this._skip=d;return this},limit:function(d){this._limit=d;return this},equalTo:function(d,e){this._where[d]=c._encode(e);return this},_addCondition:function(d,f,e){if(!this._where[d]){this._where[d]={}}this._where[d][f]=c._encode(e);return this},notEqualTo:function(d,e){this._addCondition(d,"$ne",e);return this},lessThan:function(d,e){this._addCondition(d,"$lt",e);return this},greaterThan:function(d,e){this._addCondition(d,"$gt",e);return this},lessThanOrEqualTo:function(d,e){this._addCondition(d,"$lte",e);return this},greaterThanOrEqualTo:function(d,e){this._addCondition(d,"$gte",e);return this},containedIn:function(e,d){this._addCondition(e,"$in",d);return this},notContainedIn:function(e,d){this._addCondition(e,"$nin",d);return this},containsAll:function(e,d){this._addCondition(e,"$all",d);return this},exists:function(d){this._addCondition(d,"$exists",true);return this},doesNotExist:function(d){this._addCondition(d,"$exists",false);return this},matches:function(e,f,d){this._addCondition(e,"$regex",f);if(!d){d=""}if(f.ignoreCase){d+="i"}if(f.multiline){d+="m"}if(d&&d.length){this._addCondition(e,"$options",d)}return this},matchesQuery:function(d,f){var e=f.toJSON();e.className=f.className;this._addCondition(d,"$inQuery",e);return this},doesNotMatchQuery:function(d,f){var e=f.toJSON();e.className=f.className;this._addCondition(d,"$notInQuery",e);return this},matchesKeyInQuery:function(f,e,h){var g=h.toJSON();var d={};d.className=h.className;d.where=g.where;this._addCondition(f,"$select",{query:d,key:e});return this},doesNotMatchKeyInQuery:function(e,d,g){var f=g.toJSON();f.className=g.className;this._addCondition(e,"$dontSelect",{key:d,query:f});return this},_orQuery:function(d){var e=b.map(d,function(f){return f.toJSON().where});this._where.$or=e;return this},_quote:function(d){return"\\Q"+d.replace("\\E","\\E\\\\E\\Q")+"\\E"},ascending:function(d){this._order=d;return this},descending:function(d){this._order="-"+d;return this},include:function(){var d=this;c._arrayEach(arguments,function(e){if(b.isArray(e)){d._include=d._include.concat(e)}else{d._include.push(e)}});return this},relatedTo:function(e,g,f){var d=this;var h={};h.__type="Pointer";h.className=g;h.objectId=e;d._addCondition("$relatedTo","object",h);d._addCondition("$relatedTo","key",f);return this},select:function(){var d=this;this._select=this._select||[];c._arrayEach(arguments,function(e){if(b.isArray(e)){d._select=d._select.concat(e)}else{d._select.push(e)}});return this},each:function(i,e){e=e||{};if(this._order||this._skip||(this._limit>=0)){var d="Cannot iterate on a query with sort, skip, or limit.";return c.Promise.error(d)._thenRunCallbacks(e)}var g=new c.Promise();var f=new c.Query(this.objectClass);f._limit=e.batchSize||100;f._where=b.clone(this._where);f._include=b.clone(this._include);f.ascending("objectId");var h=false;return c.Promise._continueWhile(function(){return !h},function(){return f.find().then(function(j){var k=c.Promise.as();c._.each(j,function(l){k=k.then(function(){return i(l)})});return k.then(function(){if(j.length>=f._limit){f.greaterThan("objectId",j[j.length-1].id)}else{h=true}})})})._thenRunCallbacks(e)}}}(this));(function(a){a.NCMB=a.NCMB||{};var c=a.NCMB;var b=c._;c.User=c.Object.extend("user",{_isCurrentUser:false,_mergeMagicFields:function(d){if(d.sessionToken){this._sessionToken=d.sessionToken;delete d.sessionToken}c.User.__super__._mergeMagicFields.call(this,d)},_cleanupAuthData:function(){if(!this.isCurrent()){return}var d=this.get("authData");if(!d){return}c._objectEach(this.get("authData"),function(f,e){if(!d[e]){delete d[e]}})},_synchronizeAllAuthData:function(){var e=this.get("authData");if(!e){return}var d=this;c._objectEach(this.get("authData"),function(g,f){d._synchronizeAuthData(f)})},_synchronizeAuthData:function(g){if(!this.isCurrent()){return}var d;if(b.isString(g)){d=g;g=c.User._authProviders[d]}else{d=g.getAuthType()}var e=this.get("authData");if(!e||!g){return}var f=g.restoreAuthentication(e[d]);if(!f){this._unlinkFrom(g)}},_handleSaveResult:function(d){if(d){this._isCurrentUser=true}this._cleanupAuthData();this._synchronizeAllAuthData();delete this._serverData.password;this._rebuildEstimatedDataForKey("password");this._refreshCache();if(d||this.isCurrent()){c.User._saveCurrentUser(this)}},_linkWith:function(j,f){var e;if(b.isString(j)){e=j;j=c.User._authProviders[j]}else{e=j.getAuthType()}if(b.has(f,"authData")){var g=this.get("authData")||{};g[e]=f.authData;if(e=="facebook"){if(g[e]){if(g[e]["expiration_date"]){g[e]["expiration_date"]={__type:"Date",iso:g[e]["expiration_date"]}}}}this.set("authData",g);var i=b.clone(f)||{};i.success=function(k){k._handleSaveResult(true);if(f.success){f.success.apply(this,arguments)}};return this.save({authData:g},i)}else{var d=this;var h=new c.Promise();j.authenticate({success:function(l,k){d._linkWith(l,{authData:k,success:f.success,error:f.error}).then(function(){h.resolve(d)})},error:function(l,k){if(f.error){f.error(d,k)}h.reject(k)}});return h}},_unlinkFrom:function(h,f){var e;if(b.isString(h)){e=h}else{e=h.getAuthType()}var g=b.clone(f);var d=this;if(!g){g={}}g.authData=null;g.success=function(i){d._synchronizeAuthData(h);if(f){if(f.success){f.success.apply(this,arguments)}}};return this._linkWith(h,g)},_isLinked:function(f){var d;if(b.isString(f)){d=f}else{d=f.getAuthType()}var e=this.get("authData")||{};return !!e[d]},_logOutWithAll:function(){var e=this.get("authData");if(!e){return}var d=this;c._objectEach(this.get("authData"),function(g,f){d._logOutWith(f)})},_logOutWith:function(d){if(!this.isCurrent()){return}if(b.isString(d)){d=c.User._authProviders[d]}if(d&&d.deauthenticate){d.deauthenticate()}},signUp:function(g,f){var e;f=f||{};var h=(g&&g.userName)||this.get("userName");if(!h||(h==="")){e=new c.Error(c.Error.OTHER_CAUSE,"Cannot sign up user with an empty name.");if(f&&f.error){f.error(this,e)}return c.Promise.error(e)}var d=(g&&g.password)||this.get("password");if(!d||(d==="")){e=new c.Error(c.Error.OTHER_CAUSE,"Cannot sign up user with an empty password.");if(f&&f.error){f.error(this,e)}return c.Promise.error(e)}var i=b.clone(f);i.success=function(j){j._handleSaveResult(true);if(f.success){f.success.apply(this,arguments)}};return this.save(g,i)},logIn:function(e){var d=this;var f=c._request("login",null,null,"GET",this.toJSON());return f.then(function(j,g,i){var h=d.parse(j,g,i);d._finishFetch(h);d._handleSaveResult(true);return d})._thenRunCallbacks(e,this)},save:function(h,e){var f,d,j,e,g;d=h;e=e||{};var k=b.clone(e);k.success=function(i){i._handleSaveResult(false);if(e.success){e.success.apply(this,arguments)}};return c.Object.prototype.save.call(this,d,k)},fetch:function(d){var e=d?b.clone(d):{};e.success=function(f){f._handleSaveResult(false);if(d&&d.success){d.success.apply(this,arguments)}};return c.Object.prototype.fetch.call(this,e)},isCurrent:function(){return this._isCurrentUser},getUsername:function(){return this.get("userName")},setUsername:function(e,d){return this.set("userName",e,d)},setPassword:function(e,d){return this.set("password",e,d)},getEmail:function(){return this.get("mailAddress")},setEmail:function(e,d){return this.set("mailAddress",e,d)},authenticated:function(){return !!this._sessionToken&&(c.User.current()&&c.User.current().id===this.id)}},{_currentUser:null,_currentUserMatchesDisk:false,_CURRENT_USER_KEY:"currentUser",_authProviders:{},signUp:function(h,g,f,e){f=f||{};f.userName=h;f.password=g;var d=c.Object._create("user");return d.signUp(f,e)},logIn:function(g,f,e){var d=c.Object._create("user");d._finishFetch({userName:g,password:f});return d.logIn(e)},logOut:function(){if(c.User._currentUser!==null){c.User._currentUser._logOutWithAll();c.User._currentUser._isCurrentUser=false}c.User._currentUserMatchesDisk=true;c.User._currentUser=null;c.localStorage.removeItem(c._getNCMBPath(c.User._CURRENT_USER_KEY))},requestPasswordReset:function(e,d){var f={mailAddress:e};var g=c._request("requestPasswordReset",null,null,"POST",f);return g._thenRunCallbacks(d)},current:function(){if(c.User._currentUser){return c.User._currentUser}if(c.User._currentUserMatchesDisk){return c.User._currentUser}c.User._currentUserMatchesDisk=true;var d=c.localStorage.getItem(c._getNCMBPath(c.User._CURRENT_USER_KEY));if(!d){return null}c.User._currentUser=c.Object._create("user");c.User._currentUser._isCurrentUser=true;var e=JSON.parse(d);c.User._currentUser.id=e._id;delete e._id;c.User._currentUser._sessionToken=e._sessionToken;delete e._sessionToken;c.User._currentUser.set(e);c.User._currentUser._synchronizeAllAuthData();c.User._currentUser._refreshCache();c.User._currentUser._opSetQueue=[{}];return c.User._currentUser},_saveCurrentUser:function(d){if(c.User._currentUser!==d){c.User.logOut()}d._isCurrentUser=true;c.User._currentUser=d;c.User._currentUserMatchesDisk=true;var e=d.toJSON();e._id=d.id;e._sessionToken=d._sessionToken;c.localStorage.setItem(c._getNCMBPath(c.User._CURRENT_USER_KEY),JSON.stringify(e))},_registerAuthenticationProvider:function(d){c.User._authProviders[d.getAuthType()]=d;if(c.User.current()){c.User.current()._synchronizeAuthData(d.getAuthType())}},_logInWith:function(g,e){if(g=="anonymous"){var f={};f.id=c._createUuid();e.authData=f}var d=c.Object._create("user");return d._linkWith(g,e)}})}(this));(function(a){a.NCMB=a.NCMB||{};var c=a.NCMB;var b=c._;c.AnonymousUtils={isLink:function(d){return d._isLinked("anonymous")},logIn:function(d){return c.User._logInWith("anonymous",d)}}}(this));(function(a){a.NCMB=a.NCMB||{};var d=a.NCMB;var c=d._;d.Collection=function(f,e){e=e||{};if(e.comparator){this.comparator=e.comparator}if(e.model){this.model=e.model}if(e.query){this.query=e.query}this._reset();this.initialize.apply(this,arguments);if(f){this.reset(f,{silent:true,NCMB:e.parse})}};c.extend(d.Collection.prototype,d.Events,{model:d.Object,initialize:function(){},toJSON:function(){return this.map(function(e){return e.toJSON()})},add:function(f,o){var k,m,h,l,n,g,j={},e={};o=o||{};f=c.isArray(f)?f.slice():[f];for(k=0,h=f.length;k<h;k++){f[k]=this._prepareModel(f[k],o);l=f[k];if(!l){throw new Error("Can't add an invalid model to a collection")}n=l.cid;if(j[n]||this._byCid[n]){throw new Error("Duplicate cid: can't add the same model to a collection twice")}g=l.id;if(!d._isNullOrUndefined(g)&&(e[g]||this._byId[g])){throw new Error("Duplicate id: can't add the same model to a collection twice")}e[g]=l;j[n]=l}for(k=0;k<h;k++){(l=f[k]).on("all",this._onModelEvent,this);this._byCid[l.cid]=l;if(l.id){this._byId[l.id]=l}}this.length+=h;m=d._isNullOrUndefined(o.at)?this.models.length:o.at;this.models.splice.apply(this.models,[m,0].concat(f));if(this.comparator){this.sort({silent:true})}if(o.silent){return this}for(k=0,h=this.models.length;k<h;k++){l=this.models[k];if(j[l.cid]){o.index=k;l.trigger("add",l,this,o)}}return this},remove:function(k,h){var j,e,g,f;h=h||{};k=c.isArray(k)?k.slice():[k];for(j=0,e=k.length;j<e;j++){f=this.getByCid(k[j])||this.get(k[j]);if(!f){continue}delete this._byId[f.id];delete this._byCid[f.cid];g=this.indexOf(f);this.models.splice(g,1);this.length--;if(!h.silent){h.index=g;f.trigger("remove",f,this,h)}this._removeReference(f)}return this},get:function(e){return e&&this._byId[e.id||e]},getByCid:function(e){return e&&this._byCid[e.cid||e]},at:function(e){return this.models[e]},sort:function(f){f=f||{};if(!this.comparator){throw new Error("Cannot sort a set without a comparator")}var e=c.bind(this.comparator,this);if(this.comparator.length===1){this.models=this.sortBy(e)}else{this.models.sort(e)}if(!f.silent){this.trigger("reset",this,f)}return this},pluck:function(e){return c.map(this.models,function(f){return f.get(e)})},reset:function(g,f){var e=this;g=g||[];f=f||{};d._arrayEach(this.models,function(h){e._removeReference(h)});this._reset();this.add(g,{silent:true,NCMB:f.parse});if(!f.silent){this.trigger("reset",this,f)}return this},fetch:function(e){e=c.clone(e)||{};if(e.parse===undefined){e.parse=true}var g=this;var f=this.query||new d.Query(this.model);return f.find().then(function(h){if(e.add){g.add(h,e)}else{g.reset(h,e)}return g})._thenRunCallbacks(e,this)},create:function(f,e){var g=this;e=e?c.clone(e):{};f=this._prepareModel(f,e);if(!f){return false}if(!e.wait){g.add(f,e)}var h=e.success;e.success=function(i,k,j){if(e.wait){g.add(i,e)}if(h){h(i,k)}else{i.trigger("sync",f,k,e)}};f.save(null,e);return f},parse:function(f,e){return f},chain:function(){return c(this.models).chain()},_reset:function(e){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(g,f){if(!(g instanceof d.Object)){var e=g;f.collection=this;g=new this.model(e,f);if(!g._validate(g.attributes,f)){g=false}}else{if(!g.collection){g.collection=this}}return g},_removeReference:function(e){if(this===e.collection){delete e.collection}e.off("all",this._onModelEvent,this)},_onModelEvent:function(g,f,h,e){if((g==="add"||g==="remove")&&h!==this){return}if(g==="destroy"){this.remove(f,e)}if(f&&g==="change:objectId"){delete this._byId[f.previous("objectId")];this._byId[f.id]=f}this.trigger.apply(this,arguments)}});var b=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];d._arrayEach(b,function(e){d.Collection.prototype[e]=function(){return c[e].apply(c,[this.models].concat(c.toArray(arguments)))}});d.Collection.extend=d._extend}(this));(function(a){a.NCMB=a.NCMB||{};var b=a.NCMB;b.Installation=b.Object.extend("_Installation");b.Push=b.Object.extend("Push",{constructor:function(c){this._data=c},save:function(e,c){if(!e){if(this._data){e=this._data}else{e={}}}if(e.searchCondition){e.searchCondition=b._encode(e.searchCondition)}if(e.deliveryExpirationDate){e.deliveryExpirationDate=b._encode(e.deliveryExpirationDate)}if(e.deliveryTime){e.deliveryTime=b._encode(e.deliveryTime)}if(e.deliveryExpirationTime){e.deliveryExpirationTime=b._encode(e.deliveryExpirationTime)}if(e.deliveryExpirationDate&&e.deliveryExpirationTime){throw"Both expiration_time and expiration_time_interval can't be set"}var d=b._request("push",null,null,"POST",e);return d._thenRunCallbacks(c)}});b.Push.send=function(e,c){if(e.searchCondition){e.searchCondition=b._encode(e.searchCondition)}if(e.deliveryExpirationDate){e.deliveryExpirationDate=b._encode(e.deliveryExpirationDate)}if(e.deliveryTime){e.deliveryTime=b._encode(e.deliveryTime)}if(e.deliveryExpirationTime){e.deliveryExpirationTime=b._encode(e.deliveryExpirationTime)}if(e.deliveryExpirationDate&&e.deliveryExpirationTime){throw"Both expiration_time and expiration_time_interval can't be set"}var d=b._request("push",null,null,"POST",e);return d._thenRunCallbacks(c)}}(this));(function(a){a.NCMB=a.NCMB||{};var d=a.NCMB;var c=d._;var b="*";var g=false;var h;var e;var f={authenticate:function(j){var i=this;FB.login(function(k){if(k.authResponse){if(j.success){j.success(i,{id:k.authResponse.userID,access_token:k.authResponse.accessToken,expiration_date:new Date(k.authResponse.expiresIn*1000+(new Date()).getTime()).toJSON()})}}else{if(j.error){j.error(i,k)}}},{scope:h})},restoreAuthentication:function(j){if(j){var i={userID:j.id,accessToken:j.access_token,expiresIn:(d._NCMBDate(j.expiration_date.iso).getTime()-(new Date()).getTime())/1000};var k=c.clone(e);k.authResponse=i;k.status=false;FB.init(k)}return true},getAuthType:function(){return"facebook"},deauthenticate:function(){this.restoreAuthentication(null);FB.logout()}};d.FacebookUtils={init:function(i){if(typeof(FB)==="undefined"){throw"The Facebook JavaScript SDK must be loaded before calling init."}e=c.clone(i)||{};if(e.status&&typeof(console)!=="undefined"){var j=console.warn||console.log||function(){}}e.status=false;FB.init(e);d.User._registerAuthenticationProvider(f);g=true},isLinked:function(i){return i._isLinked("facebook")},logIn:function(j,i){if(!j||c.isString(j)){if(!g){throw"You must initialize FacebookUtils before calling logIn."}h=j;return d.User._logInWith("facebook",i)}else{var k=c.clone(i)||{};k.authData=j;return d.User._logInWith("facebook",k)}},link:function(i,k,j){if(!k||c.isString(k)){if(!g){throw"You must initialize FacebookUtils before calling link."}h=k;return i._linkWith("facebook",j)}else{var l=c.clone(j)||{};l.authData=k;return i._linkWith("facebook",l)}},unlink:function(i,j){if(!g){throw"You must initialize FacebookUtils before calling unlink."}return i._unlinkFrom("facebook",j)}}}(this));(function(a){a.NCMB=a.NCMB||{};var e=a.NCMB;var d=e._;e.View=function(f){this.cid=d.uniqueId("view");this._configure(f||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var c=/^(\S+)\s*(.*)$/;var b=["model","collection","el","id","attributes","className","tagName"];d.extend(e.View.prototype,e.Events,{tagName:"div",$:function(f){return this.$el.find(f)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();return this},make:function(g,f,i){var h=document.createElement(g);if(f){e.$(h).attr(f)}if(i){e.$(h).html(i)}return h},setElement:function(f,g){this.$el=e.$(f);this.el=this.$el[0];if(g!==false){this.delegateEvents()}return this},delegateEvents:function(g){g=g||e._getValue(this,"events");if(!g){return}this.undelegateEvents();var f=this;e._objectEach(g,function(l,k){if(!d.isFunction(l)){l=f[g[k]]}if(!l){throw new Error('Event "'+g[k]+'" does not exist')}var j=k.match(c);var i=j[1],h=j[2];l=d.bind(l,f);i+=".delegateEvents"+f.cid;if(h===""){f.$el.bind(i,l)}else{f.$el.delegate(h,i,l)}})},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(g){if(this.options){g=d.extend({},this.options,g)}var f=this;d.each(b,function(h){if(g[h]){f[h]=g[h]}});this.options=g},_ensureElement:function(){if(!this.el){var f=e._getValue(this,"attributes")||{};if(this.id){f.id=this.id}if(this.className){f["class"]=this.className}this.setElement(this.make(this.tagName,f),false)}else{this.setElement(this.el,false)}}});e.View.extend=e._extend}(this));(function(b){b.NCMB=b.NCMB||{};var d=b.NCMB;var c=d._;d.Router=function(g){g=g||{};if(g.routes){this.routes=g.routes}this._bindRoutes();this.initialize.apply(this,arguments)};var e=/:\w+/g;var f=/\*\w+/g;var a=/[\-\[\]{}()+?.,\\\^\$\|#\s]/g;c.extend(d.Router.prototype,d.Events,{initialize:function(){},route:function(g,h,i){d.history=d.history||new d.History();if(!c.isRegExp(g)){g=this._routeToRegExp(g)}if(!i){i=this[h]}d.history.route(g,c.bind(function(k){var j=this._extractParameters(g,k);if(i){i.apply(this,j)}this.trigger.apply(this,["route:"+h].concat(j));d.history.trigger("route",this,h,j)},this));return this},navigate:function(h,g){d.history.navigate(h,g)},_bindRoutes:function(){if(!this.routes){return}var h=[];for(var j in this.routes){if(this.routes.hasOwnProperty(j)){h.unshift([j,this.routes[j]])}}for(var k=0,g=h.length;k<g;k++){this.route(h[k][0],h[k][1],this[h[k][1]])}},_routeToRegExp:function(g){g=g.replace(a,"\\$&").replace(e,"([^/]+)").replace(f,"(.*?)");return new RegExp("^"+g+"$")},_extractParameters:function(g,h){return g.exec(h).slice(1)}});d.Router.extend=d._extend}(this));(function(a){a.NCMB=a.NCMB||{};var d=a.NCMB;var c=d._;d.History=function(){this.handlers=[];c.bindAll(this,"checkUrl")};var e=/^[#\/]/;var b=/msie [\w.]+/;d.History.started=false;c.extend(d.History.prototype,d.Events,{interval:50,getHash:function(h){var g=h?h.location:window.location;var f=g.href.match(/#(.*)$/);return f?f[1]:""},getFragment:function(g,f){if(d._isNullOrUndefined(g)){if(this._hasPushState||f){g=window.location.pathname;var h=window.location.search;if(h){g+=h}}else{g=this.getHash()}}if(!g.indexOf(this.options.root)){g=g.substr(this.options.root.length)}return g.replace(e,"")},start:function(h){if(d.History.started){throw new Error("NCMB.history has already been started")}d.History.started=true;this.options=c.extend({},{root:"/"},this.options,h);this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var g=this.getFragment();var f=document.documentMode;var j=(b.exec(navigator.userAgent.toLowerCase())&&(!f||f<=7));if(j){this.iframe=d.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(g)}if(this._hasPushState){d.$(window).bind("popstate",this.checkUrl)}else{if(this._wantsHashChange&&("onhashchange" in window)&&!j){d.$(window).bind("hashchange",this.checkUrl)}else{if(this._wantsHashChange){this._checkUrlInterval=window.setInterval(this.checkUrl,this.interval)}}}this.fragment=g;var k=window.location;var i=k.pathname===this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!i){this.fragment=this.getFragment(null,true);window.location.replace(this.options.root+"#"+this.fragment);return true}else{if(this._wantsPushState&&this._hasPushState&&i&&k.hash){this.fragment=this.getHash().replace(e,"");window.history.replaceState({},document.title,k.protocol+"//"+k.host+this.options.root+this.fragment)}}if(!this.options.silent){return this.loadUrl()}},stop:function(){d.$(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl);window.clearInterval(this._checkUrlInterval);d.History.started=false},route:function(f,g){this.handlers.unshift({route:f,callback:g})},checkUrl:function(g){var f=this.getFragment();if(f===this.fragment&&this.iframe){f=this.getFragment(this.getHash(this.iframe))}if(f===this.fragment){return false}if(this.iframe){this.navigate(f)}if(!this.loadUrl()){this.loadUrl(this.getHash())}},loadUrl:function(h){var g=this.fragment=this.getFragment(h);var f=c.any(this.handlers,function(i){if(i.route.test(g)){i.callback(g);return true}});return f},navigate:function(h,g){if(!d.History.started){return false}if(!g||g===true){g={trigger:g}}var i=(h||"").replace(e,"");if(this.fragment===i){return}if(this._hasPushState){if(i.indexOf(this.options.root)!==0){i=this.options.root+i}this.fragment=i;var f=g.replace?"replaceState":"pushState";window.history[f]({},document.title,i)}else{if(this._wantsHashChange){this.fragment=i;this._updateHash(window.location,i,g.replace);if(this.iframe&&(i!==this.getFragment(this.getHash(this.iframe)))){if(!g.replace){this.iframe.document.open().close()}this._updateHash(this.iframe.location,i,g.replace)}}else{window.location.assign(this.options.root+h)}}if(g.trigger){this.loadUrl(h)}},_updateHash:function(f,g,h){if(h){var i=f.toString().replace(/(javascript:|#).*$/,"");f.replace(i+"#"+g)}else{f.hash=g}}})}(this));